
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Introduction/">
      
      
        <link rel="next" href="../../Practical_Malware_Analysis/Chapter%200/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.8">
    
    
      
        <title>Windows Obfuscation Techniques - irboi746's space</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4b4a2bd9.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="irboi746&#39;s space" class="md-header__button md-logo" aria-label="irboi746's space" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            irboi746's space
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Windows Obfuscation Techniques
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="irboi746&#39;s space" class="md-nav__button md-logo" aria-label="irboi746's space" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    irboi746's space
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Burp Academy
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Burp Academy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Apprentice
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Apprentice
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Burp_Academy/Apprentice/Access%20Control%20Vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Burp_Academy/Apprentice/Authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Burp_Academy/Apprentice/Business%20Logic%20Vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Business Logic Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Burp_Academy/Apprentice/CSRF%2C%20Clickjacking%20and%20CORS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSRF, Clickjacking and CORS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Burp_Academy/Apprentice/Cross%20Site%20Scripting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Scripting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Burp_Academy/Apprentice/DOM-based%20XSS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM based XSS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Burp_Academy/Apprentice/HTTP%20Host%20Header%20Attacks%20and%20File%20Upload%20Vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Host Header Attacks & File Upload Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Burp_Academy/Apprentice/Information%20Disclosure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Information Disclosure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Burp_Academy/Apprentice/JWT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JWT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Burp_Academy/Apprentice/Other%20Labs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Other Labs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Burp_Academy/Apprentice/SQL%20Injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Burp_Academy/Apprentice/XXE%20and%20SSRF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XXE and SSRF
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Practitioner
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Practitioner
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Burp_Academy/Practitioner/SQL%20Injection%20DB%20Enumeration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection DB Enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Burp_Academy/Practitioner/SQL%20Injection%20UNION%20Attack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection UNION Attack
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CTF
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            CTF
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../CTF/TISC%202022%20%281%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSIT TISC 2022 (1)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../CTF/TISC%202022%20%282%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSIT TISC 2022 (2)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Flareon22
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Flareon22
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../CTF/Flareon22/FlareOn_22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flareon-22
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dev
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Dev
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Java
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Java
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Java/Burp%20Extension%20-%20GUI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Burp Extension - GUI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Java/Burp%20Extension%20-%20Hello%20World/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Burp Extension - Hello World
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Java/Burp%20Extension%20-%20README/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Burp Extension   README
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Javascript
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Javascript
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Javascript/Node.js/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node.js
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Javascript/Node.js_Projects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NodeJS Projects
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Dev/Python/Web%20Automation%20Cheatsheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Automation Cheatsheet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Malware Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Malware Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../File_Identification%26Classification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Identification and Classification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Windows Obfuscation Techniques
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Windows Obfuscation Techniques
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodingencryption-techniques" class="md-nav__link">
    Encoding/Encryption Techniques
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packer-and-cryptors" class="md-nav__link">
    Packer and Cryptors
  </a>
  
    <nav class="md-nav" aria-label="Packer and Cryptors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#signs-of-packing" class="md-nav__link">
    Signs of Packing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packing-unpacking-process" class="md-nav__link">
    Packing &amp; Unpacking Process
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unpacking" class="md-nav__link">
    Unpacking
  </a>
  
    <nav class="md-nav" aria-label="Unpacking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#approaches-in-unpacking" class="md-nav__link">
    Approaches in Unpacking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods-in-unpacking" class="md-nav__link">
    Methods in Unpacking
  </a>
  
    <nav class="md-nav" aria-label="Methods in Unpacking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automated-static-unpacking" class="md-nav__link">
    Automated Static Unpacking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-dynamic-unpacking" class="md-nav__link">
    Automated Dynamic Unpacking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-unpacking" class="md-nav__link">
    Manual Unpacking
  </a>
  
    <nav class="md-nav" aria-label="Manual Unpacking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-1-reverser-program" class="md-nav__link">
    Method 1 - Reverser Program
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-2-dynamic-unpacking" class="md-nav__link">
    Method 2 - Dynamic Unpacking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-packers" class="md-nav__link">
    Common Packers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anti-analysis-techniques" class="md-nav__link">
    Anti-Analysis Techniques
  </a>
  
    <nav class="md-nav" aria-label="Anti-Analysis Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anti-debug-techniques" class="md-nav__link">
    Anti-Debug Techniques
  </a>
  
    <nav class="md-nav" aria-label="Anti-Debug Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#isdebuggerpresent" class="md-nav__link">
    IsDebuggerPresent
  </a>
  
    <nav class="md-nav" aria-label="IsDebuggerPresent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description1" class="md-nav__link">
    Description1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isdebugged-field" class="md-nav__link">
    IsDebugged Field
  </a>
  
    <nav class="md-nav" aria-label="IsDebugged Field">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description-1415" class="md-nav__link">
    Description 1415
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_1" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ntglobalflag" class="md-nav__link">
    NtGlobalFlag
  </a>
  
    <nav class="md-nav" aria-label="NtGlobalFlag">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    Description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_2" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkremotedebuggerpresent" class="md-nav__link">
    CheckRemoteDebuggerPresent
  </a>
  
    <nav class="md-nav" aria-label="CheckRemoteDebuggerPresent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description4" class="md-nav__link">
    Description4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_3" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#closehandlentclose" class="md-nav__link">
    CloseHandle/NtClose
  </a>
  
    <nav class="md-nav" aria-label="CloseHandle/NtClose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description678" class="md-nav__link">
    Description678
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass8" class="md-nav__link">
    Bypass8
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#findwindow" class="md-nav__link">
    FindWindow
  </a>
  
    <nav class="md-nav" aria-label="FindWindow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description910" class="md-nav__link">
    Description910
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass11" class="md-nav__link">
    Bypass11
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#self-debugging-using-debugactiveprocess" class="md-nav__link">
    Self-Debugging using DebugActiveProcess
  </a>
  
    <nav class="md-nav" aria-label="Self-Debugging using DebugActiveProcess">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_1" class="md-nav__link">
    Description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_4" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outputdebugstring" class="md-nav__link">
    OutputDebugString
  </a>
  
    <nav class="md-nav" aria-label="OutputDebugString">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_2" class="md-nav__link">
    Description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_5" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structured-exception-handling-seh" class="md-nav__link">
    Structured Exception Handling (SEH)
  </a>
  
    <nav class="md-nav" aria-label="Structured Exception Handling (SEH)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description16" class="md-nav__link">
    Description16
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-callback" class="md-nav__link">
    TLS Callback
  </a>
  
    <nav class="md-nav" aria-label="TLS Callback">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_3" class="md-nav__link">
    Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-breakpoint-detection" class="md-nav__link">
    Software Breakpoint Detection
  </a>
  
    <nav class="md-nav" aria-label="Software Breakpoint Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description17" class="md-nav__link">
    Description17
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_6" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware-breakpoint-detection" class="md-nav__link">
    Hardware Breakpoint Detection
  </a>
  
    <nav class="md-nav" aria-label="Hardware Breakpoint Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description-18" class="md-nav__link">
    Description 18
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_7" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trap-flag" class="md-nav__link">
    Trap Flag
  </a>
  
    <nav class="md-nav" aria-label="Trap Flag">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description-20" class="md-nav__link">
    Description 20
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#illustration-19" class="md-nav__link">
    Illustration 19
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_8" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interrupts" class="md-nav__link">
    Interrupts
  </a>
  
    <nav class="md-nav" aria-label="Interrupts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description21" class="md-nav__link">
    Description21
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_9" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timing" class="md-nav__link">
    Timing
  </a>
  
    <nav class="md-nav" aria-label="Timing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_4" class="md-nav__link">
    Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-disassembly-techniques" class="md-nav__link">
    Anti-Disassembly Techniques
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-vm-techniques" class="md-nav__link">
    Anti-VM Techniques
  </a>
  
    <nav class="md-nav" aria-label="Anti-VM Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__cpuid" class="md-nav__link">
    __CPUID
  </a>
  
    <nav class="md-nav" aria-label="__CPUID">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_5" class="md-nav__link">
    Description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_10" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmx-instruction-set" class="md-nav__link">
    MMX Instruction Set
  </a>
  
    <nav class="md-nav" aria-label="MMX Instruction Set">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_6" class="md-nav__link">
    Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vmware-magic-number" class="md-nav__link">
    VMWare 'Magic Number'
  </a>
  
    <nav class="md-nav" aria-label="VMWare 'Magic Number'">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description22" class="md-nav__link">
    Description22
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-23" class="md-nav__link">
    Bypass 23
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#known-mac-address" class="md-nav__link">
    Known MAC Address
  </a>
  
    <nav class="md-nav" aria-label="Known MAC Address">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_7" class="md-nav__link">
    Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registry-key" class="md-nav__link">
    Registry Key
  </a>
  
    <nav class="md-nav" aria-label="Registry Key">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_8" class="md-nav__link">
    Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checking-for-vm-processes-files-services" class="md-nav__link">
    Checking for VM Processes, Files &amp; Services
  </a>
  
    <nav class="md-nav" aria-label="Checking for VM Processes, Files & Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description-24" class="md-nav__link">
    Description 24
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#process-hollowing" class="md-nav__link">
    Process Hollowing
  </a>
  
    <nav class="md-nav" aria-label="Process Hollowing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#illustration-of-proccess-hollowing" class="md-nav__link">
    Illustration of Proccess Hollowing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-api-monitor-to-observe-process-hollowing" class="md-nav__link">
    Using API Monitor to Observe Process Hollowing
  </a>
  
    <nav class="md-nav" aria-label="Using API Monitor to Observe Process Hollowing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-up-monitoring" class="md-nav__link">
    Set-Up Monitoring
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specify-application-to-monitor" class="md-nav__link">
    Specify Application to Monitor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#before-running" class="md-nav__link">
    Before Running
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debugging" class="md-nav__link">
    Debugging
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#footnote" class="md-nav__link">
    Footnote
  </a>
  
    <nav class="md-nav" aria-label="Footnote">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anti-debug" class="md-nav__link">
    Anti-Debug
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-vm" class="md-nav__link">
    Anti-VM
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Practical Malware Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Practical Malware Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Practical_Malware_Analysis/Chapter%200/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter 0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Practical_Malware_Analysis/Chapter%201/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Practical_Malware_Analysis/Chapter%203/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter 3
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    OWASP Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            OWASP Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../OWASP_Labs/Generic%20University/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generic University
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../OWASP_Labs/crAPI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    crAPI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PG
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            PG
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../PG/Linux%20-%20Cassios/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cassios
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    RE101
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            RE101
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../RE101/3.%20Simple%20Lambdas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Simple Lambdas
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Random Thoughts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Random Thoughts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Random_Thoughts/010622-1824/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Pentest or... not?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Random_Thoughts/Building%20a%20Personal%20Containerized%20Web%20Pentest%20Lab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building a Personal Containerized Web Pentest Lab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../Random_Thoughts/Password%20Management%20with%20Self-Hosted%20KeeWeb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Password Management with Self-Hosted KeeWeb
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encodingencryption-techniques" class="md-nav__link">
    Encoding/Encryption Techniques
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packer-and-cryptors" class="md-nav__link">
    Packer and Cryptors
  </a>
  
    <nav class="md-nav" aria-label="Packer and Cryptors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#signs-of-packing" class="md-nav__link">
    Signs of Packing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packing-unpacking-process" class="md-nav__link">
    Packing &amp; Unpacking Process
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unpacking" class="md-nav__link">
    Unpacking
  </a>
  
    <nav class="md-nav" aria-label="Unpacking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#approaches-in-unpacking" class="md-nav__link">
    Approaches in Unpacking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods-in-unpacking" class="md-nav__link">
    Methods in Unpacking
  </a>
  
    <nav class="md-nav" aria-label="Methods in Unpacking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automated-static-unpacking" class="md-nav__link">
    Automated Static Unpacking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automated-dynamic-unpacking" class="md-nav__link">
    Automated Dynamic Unpacking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-unpacking" class="md-nav__link">
    Manual Unpacking
  </a>
  
    <nav class="md-nav" aria-label="Manual Unpacking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-1-reverser-program" class="md-nav__link">
    Method 1 - Reverser Program
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-2-dynamic-unpacking" class="md-nav__link">
    Method 2 - Dynamic Unpacking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-packers" class="md-nav__link">
    Common Packers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anti-analysis-techniques" class="md-nav__link">
    Anti-Analysis Techniques
  </a>
  
    <nav class="md-nav" aria-label="Anti-Analysis Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anti-debug-techniques" class="md-nav__link">
    Anti-Debug Techniques
  </a>
  
    <nav class="md-nav" aria-label="Anti-Debug Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#isdebuggerpresent" class="md-nav__link">
    IsDebuggerPresent
  </a>
  
    <nav class="md-nav" aria-label="IsDebuggerPresent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description1" class="md-nav__link">
    Description1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isdebugged-field" class="md-nav__link">
    IsDebugged Field
  </a>
  
    <nav class="md-nav" aria-label="IsDebugged Field">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description-1415" class="md-nav__link">
    Description 1415
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_1" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ntglobalflag" class="md-nav__link">
    NtGlobalFlag
  </a>
  
    <nav class="md-nav" aria-label="NtGlobalFlag">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    Description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_2" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkremotedebuggerpresent" class="md-nav__link">
    CheckRemoteDebuggerPresent
  </a>
  
    <nav class="md-nav" aria-label="CheckRemoteDebuggerPresent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description4" class="md-nav__link">
    Description4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_3" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#closehandlentclose" class="md-nav__link">
    CloseHandle/NtClose
  </a>
  
    <nav class="md-nav" aria-label="CloseHandle/NtClose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description678" class="md-nav__link">
    Description678
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass8" class="md-nav__link">
    Bypass8
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#findwindow" class="md-nav__link">
    FindWindow
  </a>
  
    <nav class="md-nav" aria-label="FindWindow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description910" class="md-nav__link">
    Description910
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass11" class="md-nav__link">
    Bypass11
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#self-debugging-using-debugactiveprocess" class="md-nav__link">
    Self-Debugging using DebugActiveProcess
  </a>
  
    <nav class="md-nav" aria-label="Self-Debugging using DebugActiveProcess">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_1" class="md-nav__link">
    Description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_4" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outputdebugstring" class="md-nav__link">
    OutputDebugString
  </a>
  
    <nav class="md-nav" aria-label="OutputDebugString">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_2" class="md-nav__link">
    Description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_5" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structured-exception-handling-seh" class="md-nav__link">
    Structured Exception Handling (SEH)
  </a>
  
    <nav class="md-nav" aria-label="Structured Exception Handling (SEH)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description16" class="md-nav__link">
    Description16
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-callback" class="md-nav__link">
    TLS Callback
  </a>
  
    <nav class="md-nav" aria-label="TLS Callback">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_3" class="md-nav__link">
    Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-breakpoint-detection" class="md-nav__link">
    Software Breakpoint Detection
  </a>
  
    <nav class="md-nav" aria-label="Software Breakpoint Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description17" class="md-nav__link">
    Description17
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_6" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware-breakpoint-detection" class="md-nav__link">
    Hardware Breakpoint Detection
  </a>
  
    <nav class="md-nav" aria-label="Hardware Breakpoint Detection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description-18" class="md-nav__link">
    Description 18
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_7" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trap-flag" class="md-nav__link">
    Trap Flag
  </a>
  
    <nav class="md-nav" aria-label="Trap Flag">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description-20" class="md-nav__link">
    Description 20
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#illustration-19" class="md-nav__link">
    Illustration 19
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_8" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interrupts" class="md-nav__link">
    Interrupts
  </a>
  
    <nav class="md-nav" aria-label="Interrupts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description21" class="md-nav__link">
    Description21
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_9" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timing" class="md-nav__link">
    Timing
  </a>
  
    <nav class="md-nav" aria-label="Timing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_4" class="md-nav__link">
    Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-disassembly-techniques" class="md-nav__link">
    Anti-Disassembly Techniques
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-vm-techniques" class="md-nav__link">
    Anti-VM Techniques
  </a>
  
    <nav class="md-nav" aria-label="Anti-VM Techniques">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__cpuid" class="md-nav__link">
    __CPUID
  </a>
  
    <nav class="md-nav" aria-label="__CPUID">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_5" class="md-nav__link">
    Description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass_10" class="md-nav__link">
    Bypass
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmx-instruction-set" class="md-nav__link">
    MMX Instruction Set
  </a>
  
    <nav class="md-nav" aria-label="MMX Instruction Set">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_6" class="md-nav__link">
    Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vmware-magic-number" class="md-nav__link">
    VMWare 'Magic Number'
  </a>
  
    <nav class="md-nav" aria-label="VMWare 'Magic Number'">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description22" class="md-nav__link">
    Description22
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypass-23" class="md-nav__link">
    Bypass 23
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#known-mac-address" class="md-nav__link">
    Known MAC Address
  </a>
  
    <nav class="md-nav" aria-label="Known MAC Address">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_7" class="md-nav__link">
    Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#registry-key" class="md-nav__link">
    Registry Key
  </a>
  
    <nav class="md-nav" aria-label="Registry Key">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description_8" class="md-nav__link">
    Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checking-for-vm-processes-files-services" class="md-nav__link">
    Checking for VM Processes, Files &amp; Services
  </a>
  
    <nav class="md-nav" aria-label="Checking for VM Processes, Files & Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description-24" class="md-nav__link">
    Description 24
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#process-hollowing" class="md-nav__link">
    Process Hollowing
  </a>
  
    <nav class="md-nav" aria-label="Process Hollowing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#illustration-of-proccess-hollowing" class="md-nav__link">
    Illustration of Proccess Hollowing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-api-monitor-to-observe-process-hollowing" class="md-nav__link">
    Using API Monitor to Observe Process Hollowing
  </a>
  
    <nav class="md-nav" aria-label="Using API Monitor to Observe Process Hollowing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-up-monitoring" class="md-nav__link">
    Set-Up Monitoring
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#specify-application-to-monitor" class="md-nav__link">
    Specify Application to Monitor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#before-running" class="md-nav__link">
    Before Running
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debugging" class="md-nav__link">
    Debugging
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#footnote" class="md-nav__link">
    Footnote
  </a>
  
    <nav class="md-nav" aria-label="Footnote">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anti-debug" class="md-nav__link">
    Anti-Debug
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-vm" class="md-nav__link">
    Anti-VM
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Windows Obfuscation Techniques</h1>

<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<ul>
<li>obfuscation is a method used to transform binary and textual and textual data into unreadable form and/or hard to understand.</li>
<li>There are three broad categories of obfuscation : encoding, encryption and packing.</li>
<li>Generally, obfuscation are used to : <ol>
<li>hide C2 communication</li>
<li>avoid detection by signature-based tools (AV, IDS, IPS,  yara etc.)</li>
<li>obscure strings used in malicious binary to protect against static analysis</li>
</ol>
</li>
</ul>
<h2 id="encodingencryption-techniques">Encoding/Encryption Techniques<a class="headerlink" href="#encodingencryption-techniques" title="Permanent link">&para;</a></h2>
<ul>
<li>malware authors can add garbage lines of code or change the the execution order of the actual code without altering the inner instructions in the program to evade signature based malware detection.</li>
<li>They can also use a combination of encryption/encoding techniques to make the identification of the crypto scheme difficult.</li>
<li>Simple Arithmetic</li>
<li>where basic mathematical operation (addition,subtraction,multiplication,division) is done at byte level to encrypt / decrypt the file.</li>
<li>Caesar Cipher</li>
<li>substitution of letters in the plaintext with another letter in the alphabet by shifting the letters by a fixed number of positions.</li>
<li>XOR Cipher<ul>
<li>Interesting feature of <code>XOR</code> is that you can retrieve the plaintext from ciphertext by simply XORing with the encryption key, which means that the encryption and decryption function is the <strong>same</strong>.</li>
<li>Another interesting feature of <code>XOR</code> is that XORing a null byte (<code>0x00</code>) with the a value will yield they value.<ul>
<li>Example <code>0x05 XOR 0x00 = 0x05</code></li>
<li>therefore encoding with XOR can leak to single byte <code>XOR</code> key leak if null byte exists and partial key leaks for multi-byte <code>XOR</code>.</li>
<li>Thus malware author will ignore null bytes during encoding process so that key is not leaked. </li>
</ul>
</li>
<li>There are also 2 other mechanisms used by malware author to prevent XOR deobfuscation : <ol>
<li>Use a 2 cycle approach, where the executable is xor-ed once with one key value at first and then xor-ed again with another key value.</li>
<li>use a loop to increase XOR value. </li>
</ol>
</li>
<li>There are two types of XOR cipher Single-Byte and Multi-Byte.</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>Single Byte XOR</th>
<th>Multi Byte XOR</th>
</tr>
</thead>
<tbody>
<tr>
<td>What is it?</td>
<td>application of a  function on each byte  of the plaintext  with the encryption key  not more than 1 byte <code>0xFF</code></td>
<td>application of XOR function with a key of more than 1 byte, thus XORing a number of bytes  at a time based on the length of  the key used.</td>
</tr>
<tr>
<td>Tools</td>
<td>- XORSearch - ConverterNET <br> - Balbuzard - unXOR<br> - Cyberchef - brxor.py<br> - NoMoreXOR.py</td>
<td>- xortool</td>
</tr>
<tr>
<td>Bruteforce</td>
<td>- Easy as there is only 0xFF  number of keys</td>
<td>- Difficult as the permutations on  the number of key is way more</td>
</tr>
<tr>
<td>Null byte Key Leak</td>
<td>Full disclosure of key  if null byte is not ignored</td>
<td>Partial Disclosure of key if null byte  is not ignored</td>
</tr>
</tbody>
</table>
<ol>
<li>Base64 Encoding</li>
<li><a href="https://en.wikipedia.org/wiki/Base64">Base64 Encoding Details</a></li>
</ol>
<h2 id="packer-and-cryptors">Packer and Cryptors<a class="headerlink" href="#packer-and-cryptors" title="Permanent link">&para;</a></h2>
<ul>
<li>a packer is a software that obfuscate an executable by compressing its content and generating a new executable.</li>
<li>A cryptor functions simlar to a packer but encrypts the executable instead.</li>
<li>Malware authors use packers and/or cryptors to obfuscate their binaries and make it less detectable by AV and harder to do static analysis/reverse engineer.</li>
</ul>
<h3 id="signs-of-packing">Signs of Packing<a class="headerlink" href="#signs-of-packing" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Unusually Low number of Imports</td>
<td>Imports where there is only <code>LoadLibrary</code> or <code>GetProcAddress</code>.</td>
<td>amount of code is smaller than usual (can be viewed with IDA pro)</td>
</tr>
<tr>
<td>Unusually low number of strings</td>
<td>High Entropy</td>
<td>Unusual section which may indicate the specific packer used.<br>   - e.g UPX0, UPX1 suggesting the use of UPX</td>
</tr>
<tr>
<td>abnormal size of sections</td>
<td>analysis program (DiE/OllyDbg) indicating signs of packing.</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="packing-unpacking-process">Packing &amp; Unpacking Process<a class="headerlink" href="#packing-unpacking-process" title="Permanent link">&para;</a></h3>
<pre class="mermaid"><code>graph TD
subgraph Packing
a[Original EXE]--&gt;|Compress Content|b[Obfuscated EXE]--&gt;|add unpack stub|c[Obfuscated EXE + Unpack Stub]--&gt;|change entry point &lt;br&gt;to unpack stub|d[Packed EXE]
end

subgraph Unpacking
1[Packed EXE]--&gt;|Runs Unpack Stub|2[Extracted Original EXE]--&gt;|transfer control to original OEP|3[Original EXE runs]
end</code></pre>
<p><img alt="Pasted image 20220601163957.png" src="../Media/Pasted%20image%2020220601163957.png" />{ width="650" }</p>
<h3 id="unpacking">Unpacking<a class="headerlink" href="#unpacking" title="Permanent link">&para;</a></h3>
<ul>
<li>The unpacking stub will do 3 actions :<ol>
<li>Unpack packed executable and load it into memory</li>
<li>Fix the import table of the executable so that import can be resolved.</li>
<li>Point to the original executable's OEP(Original Entry Point).</li>
</ol>
</li>
<li>Finding the <strong>Tail Jump</strong> is the main goal of unpacking. It can be thought of as the last step of the unpacker where the next step through will lead you to the original OEP of the executable. </li>
<li>Tail Jump can come in the form of a <code>jmp</code> instruction and in more sophisticated cases a <code>ret</code> or <code>call</code> instruction. OS functions like <code>NtContinue</code> or <code>ZwContinue</code>   </li>
</ul>
<h4 id="approaches-in-unpacking">Approaches in Unpacking<a class="headerlink" href="#approaches-in-unpacking" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Approach</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>- Unpacking Stub uses <code>LoadLibrary</code> &amp; <code>GetProcAddress</code> functions <br>  - The stub reads the import information of the original file and uses  <code>LoadLibrary</code> to load the DLL in memory and then <code>GetProcAddress</code> to get  the addresses of the functions that the executable imports</td>
</tr>
<tr>
<td>2</td>
<td>- Packer does not tamper with the original import table<br> - The unpacking stub will have a loader to load the DLL and imported functions  an their addresses in memory<br> - This method lacks stealth and is usually used in packers that focuses on  compression and performance rather than security.</td>
</tr>
<tr>
<td>3</td>
<td>- Packer will keep one import function from the original import table from each DLL imported  so that only one function is revealed.<br> - stealthier than Approach 2 and much simpler to implement than Approach 1 as there is no need to  load libraries but it still is required to resolve the functions that it requires.</td>
</tr>
<tr>
<td>4</td>
<td>- Unpacker stub will have no libraries and need to search for functions needed and  rebuild the import table in runtime  <br> - An alternative will be that the unpacking stub searches for <code>LoadLibrary</code> and <code>GetProcAddress</code> functions and use them to find other libraries <br> - This is the stealthiest approach in packing</td>
</tr>
</tbody>
</table>
<h4 id="methods-in-unpacking">Methods in Unpacking<a class="headerlink" href="#methods-in-unpacking" title="Permanent link">&para;</a></h4>
<ul>
<li>Unpacking cannot recreate the original executable. </li>
<li>The goal of unpacking is to define the behaviour of the executable - to get the binary that exhibits the same behaviour as the original. </li>
</ul>
<h5 id="automated-static-unpacking">Automated Static Unpacking<a class="headerlink" href="#automated-static-unpacking" title="Permanent link">&para;</a></h5>
<ul>
<li>Using a software that acts like the unpacking stub to decompress and/or decrypt the packed file.</li>
<li>It is the fastest method and also the "safest" method as it can restore the executable without running it.</li>
<li>However, these type of unpackers are usually built for specific version of packer and are rare.</li>
</ul>
<h5 id="automated-dynamic-unpacking">Automated Dynamic Unpacking<a class="headerlink" href="#automated-dynamic-unpacking" title="Permanent link">&para;</a></h5>
<ul>
<li>A software that is able to <ol>
<li>identify the end of the execution of the unpacking stub the executable </li>
<li>run the unpacking stub that is embedded on the packed file </li>
<li>automatically rebuilds the import table and dumps out the unpacked executable.</li>
</ol>
</li>
<li>Tools : PE Explorer Plugins, CFF Explorer(UPX only)</li>
</ul>
<h5 id="manual-unpacking">Manual Unpacking<a class="headerlink" href="#manual-unpacking" title="Permanent link">&para;</a></h5>
<h6 id="method-1-reverser-program">Method 1 - Reverser Program<a class="headerlink" href="#method-1-reverser-program" title="Permanent link">&para;</a></h6>
<ul>
<li>Writing a Reverser Program based on the packing algorithm.</li>
</ul>
<h6 id="method-2-dynamic-unpacking">Method 2 - Dynamic Unpacking<a class="headerlink" href="#method-2-dynamic-unpacking" title="Permanent link">&para;</a></h6>
<ul>
<li>The idea is to run the packed library and set a breakpoint at the instruction right before <code>jmp</code> OEP. Then we step over to the next instruction where it will <code>jmp</code> to the OEP and dump the unpacked process in the memory to disk. We then proceed to fix the Import Address Table (IAT) of the dumped file. <ul>
<li>This is a good <a href="https://www.goggleheadedhacker.com/blog/post/6">illustration</a> of the above Dynamic Unpacking method.</li>
</ul>
</li>
</ul>
<h4 id="common-packers">Common Packers<a class="headerlink" href="#common-packers" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>S/N</th>
<th>Packer</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>UPX</td>
<td>- free, open source and multi-platform. <br> - focuses more on performance than security <br> - UPX application has both pack and unpack functionality <br> - Pack  <code>upx -o &lt;packed_name&gt; &lt;unpacked&gt;</code><br> - Unpack  <code>upx -d -o &lt;unpacked_name&gt; &lt;packed&gt;</code> <br> - Many malware will appear to be packed with UPX but more often than not it is a modified UPX where the commands above will not be useful <br></td>
</tr>
<tr>
<td>2</td>
<td>PE Compact</td>
<td>- Commercial packer that focuses on performance <br> - obfuscates code and has anti-debug features <br> - is extensible by third party plugins making unpacking even more difficult <br> - OllyDbg needs to be configured to pass exceptions <br> - Tail Jump method can be done, requires to look for a <code>jmp eax</code> that precedes many <code>0x00</code> bytes</td>
</tr>
<tr>
<td>3</td>
<td>ASPack</td>
<td>- Commercial packer focused on security <br> - uses different anti-debugging techniques like self-modifying code to complicate setting of breakpoints and software breakpoints may crash the program <br> - There are automated unpackers but the effectiveness varies</td>
</tr>
<tr>
<td>4</td>
<td>Petite</td>
<td>- Free packer that is focused on performance<br> - employs various anti-debug techniques like single-step exceptions <br> - the import table is untouched, thus Static Analysis can still be done</td>
</tr>
<tr>
<td>5</td>
<td>WinUpack(GUI) / Upack (CLI)</td>
<td>- Focus is on compression not security<br> - Some anti-debugging techniques employed to counter OllyDump or searching for tail jump</td>
</tr>
</tbody>
</table>
<h2 id="anti-analysis-techniques">Anti-Analysis Techniques<a class="headerlink" href="#anti-analysis-techniques" title="Permanent link">&para;</a></h2>
<ul>
<li>Malware authors use a series of mechanisms within their code to make analysis difficult. They do so by preventing the analyst from having the environment to run, debug or disassemble the malware.</li>
<li>These series of mechanisms could be the use Win32 APIs, Registry Key Value, code-level code and logic obfuscation.</li>
</ul>
<h3 id="anti-debug-techniques">Anti-Debug Techniques<a class="headerlink" href="#anti-debug-techniques" title="Permanent link">&para;</a></h3>
<ul>
<li>techniques used by malware authors to ensure that a program is not running under a debugger.</li>
<li>The Windows API is a widely used tool to detect the presence of debuggers.</li>
</ul>
<h4 id="isdebuggerpresent"><code>IsDebuggerPresent</code><a class="headerlink" href="#isdebuggerpresent" title="Permanent link">&para;</a></h4>
<h5 id="description1">Description<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup><a class="headerlink" href="#description1" title="Permanent link">&para;</a></h5>
<ul>
<li>Determines whether the calling process is being debugged by a user-mode debugger.</li>
<li>This function checks for <code>BeginDebugged</code> field in the Process Environment Block (PEB)<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup></li>
<li>the return value is nonzero if the current process is running in the context of a debugger.</li>
</ul>
<h5 id="bypass">Bypass<a class="headerlink" href="#bypass" title="Permanent link">&para;</a></h5>
<ul>
<li>Refer to this guide IsDebuggerPresent Patching<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup>. There are two methods described to bypass, one is to set <code>BeginDebugged</code> to <code>0</code> on runtime and the other is to fill the code with enough<code>NOP</code> operations. </li>
</ul>
<h4 id="isdebugged-field"><code>IsDebugged</code> Field<a class="headerlink" href="#isdebugged-field" title="Permanent link">&para;</a></h4>
<h5 id="description-1415">Description <sup id="fnref:14"><a class="footnote-ref" href="#fn:14">14</a></sup><sup id="fnref:15"><a class="footnote-ref" href="#fn:15">15</a></sup><a class="headerlink" href="#description-1415" title="Permanent link">&para;</a></h5>
<ul>
<li>This is part of the PEB and can be found at location <code>fs:[30h]</code>. It is set by the system to <code>1</code> when a debugger is present.</li>
</ul>
<h5 id="bypass_1">Bypass<a class="headerlink" href="#bypass_1" title="Permanent link">&para;</a></h5>
<p>SImilar to IsDebuggerPresent bypass, we need to change the value of the flag to zero on runtime.</p>
<h4 id="ntglobalflag"><code>NtGlobalFlag</code><a class="headerlink" href="#ntglobalflag" title="Permanent link">&para;</a></h4>
<h5 id="description">Description<a class="headerlink" href="#description" title="Permanent link">&para;</a></h5>
<ul>
<li><code>NtGlobalFlag</code> is part of the PEB with default value of <code>0</code></li>
<li>It is found at offset 0x068 (x86) or 0x0bc (x64)</li>
<li>It is made up of a set of flags and if a process is opened by a debugger, the following flags <code>FLG_HEAP_ENABLE_TAIL_CHECK (0X10)</code>, <code>FLG_HEAP_ENABLE_FREE_CHECK (0X20)</code> and <code>FLG_HEAP_VALIDATE_PARAMTERS (0X40)</code> will be set. </li>
<li>The flag value will add up to <code>0x70</code> hence a <code>NtGlobalFlag</code> with value <code>0x70</code> would signify that a debugger is used to create the process.</li>
</ul>
<h5 id="bypass_2">Bypass<a class="headerlink" href="#bypass_2" title="Permanent link">&para;</a></h5>
<ul>
<li>Similar to IsDebuggerPresent bypass, we need to change the value of the flag to zero on runtime.</li>
</ul>
<h4 id="checkremotedebuggerpresent"><code>CheckRemoteDebuggerPresent</code><a class="headerlink" href="#checkremotedebuggerpresent" title="Permanent link">&para;</a></h4>
<h5 id="description4">Description<sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup><a class="headerlink" href="#description4" title="Permanent link">&para;</a></h5>
<ul>
<li>Checks whether the current process is debugged by a remote process.</li>
<li>Usually used alongside <code>IsDebuggerPresent</code> <img alt="Pasted image 20220603140958.png" src="../Media/Pasted%20image%2020220603140958.png" /></li>
</ul>
<h5 id="bypass_3">Bypass<a class="headerlink" href="#bypass_3" title="Permanent link">&para;</a></h5>
<ul>
<li>Bypassing this is similar to bypassing <code>IsDebuggerPresent</code> where we will need to make this program return a zero value.</li>
<li>A detailed explanation of bypass can be found here<sup id="fnref:5"><a class="footnote-ref" href="#fn:5">5</a></sup></li>
</ul>
<h4 id="closehandlentclose"><code>CloseHandle</code>/<code>NtClose</code><a class="headerlink" href="#closehandlentclose" title="Permanent link">&para;</a></h4>
<h5 id="description678">Description<sup id="fnref:6"><a class="footnote-ref" href="#fn:6">6</a></sup><sup id="fnref:7"><a class="footnote-ref" href="#fn:7">7</a></sup><sup id="fnref:8"><a class="footnote-ref" href="#fn:8">8</a></sup><a class="headerlink" href="#description678" title="Permanent link">&para;</a></h5>
<ul>
<li><code>CloseHandle</code> and <code>NtClose</code> are related in the sense that when there is a function call for <code>CloseHandle</code> it will call <code>NtClose</code>.</li>
<li><code>CloseHandle</code> operates differently when debugger is attached - an exception with error value <code>0xC0000008</code> will be raised. </li>
<li>This exception code is unique to debuggers and can be detected with an exception handler and thus identifying that a debugger is present.</li>
<li>Benefit of this technique is that in a program there will be many CloseHandle calls and it makes it harder to detect anti-debugging feature.</li>
</ul>
<h5 id="bypass8">Bypass<sup id="fnref2:8"><a class="footnote-ref" href="#fn:8">8</a></sup><a class="headerlink" href="#bypass8" title="Permanent link">&para;</a></h5>
<ul>
<li>The idea of bypass would be to register your own exception handler function with <code>AddVectoredExceptionHandler</code> and hook this to CloseHandle so that the exception value above is not thrown.</li>
<li>The other method would be to <code>NOP</code> out the call to <code>CloseHandle</code>  </li>
</ul>
<h4 id="findwindow"><code>FindWindow</code><a class="headerlink" href="#findwindow" title="Permanent link">&para;</a></h4>
<h5 id="description910">Description<sup id="fnref:9"><a class="footnote-ref" href="#fn:9">9</a></sup><sup id="fnref:10"><a class="footnote-ref" href="#fn:10">10</a></sup><a class="headerlink" href="#description910" title="Permanent link">&para;</a></h5>
<ul>
<li>retrieves the handle to the top-level window whose class name and window name match the specified strings. </li>
<li>Debugger will usually have their names on the window and hence this function searches for windows with the name of the debugger.</li>
<li>The list is usually found hardcoded in the malware itself</li>
</ul>
<h5 id="bypass11">Bypass<sup id="fnref:11"><a class="footnote-ref" href="#fn:11">11</a></sup><a class="headerlink" href="#bypass11" title="Permanent link">&para;</a></h5>
<ul>
<li>Use a debugger not in the list</li>
<li><code>NOP</code> pass the FindWindow instruction as suggested in here<sup id="fnref2:11"><a class="footnote-ref" href="#fn:11">11</a></sup></li>
</ul>
<h4 id="self-debugging-using-debugactiveprocess">Self-Debugging using <code>DebugActiveProcess</code><a class="headerlink" href="#self-debugging-using-debugactiveprocess" title="Permanent link">&para;</a></h4>
<h5 id="description_1">Description<a class="headerlink" href="#description_1" title="Permanent link">&para;</a></h5>
<ul>
<li>By creating a child process that calls <code>kernel32!DebugActiveProcess</code> on the parent process the program is essentially debugging itself.</li>
<li><code>DebugActiveProcess</code> will call <code>ntdll!DbgUiDebugActiveProcess</code> which will then call <code>ntdll!NtDebugActiveProcess</code></li>
<li>If parent process is running under a debugger, the <code>NtDebugActiveProcess</code> syscall will fail. </li>
</ul>
<h5 id="bypass_4">Bypass<a class="headerlink" href="#bypass_4" title="Permanent link">&para;</a></h5>
<ul>
<li>We can follow <a href="https://anti-debug.checkpoint.com/techniques/interactive.html#mitigations">slevin_by</a> recommendation by skipping function calls with <code>NOP</code>.</li>
</ul>
<h4 id="outputdebugstring"><code>OutputDebugString</code><a class="headerlink" href="#outputdebugstring" title="Permanent link">&para;</a></h4>
<h5 id="description_2">Description<a class="headerlink" href="#description_2" title="Permanent link">&para;</a></h5>
<ul>
<li><code>OutputDebugString</code> calls <code>RaiseException</code> where the output of the <code>RaiseException</code> should be handled by the debugger. The absence of the exceptions and will signify the presence of the debugger while the presence of the exceptions will signify that a debugger is not present.</li>
<li>More details here<sup id="fnref2:12"><a class="footnote-ref" href="#fn:12">12</a></sup> and here<sup id="fnref:13"><a class="footnote-ref" href="#fn:13">13</a></sup>.</li>
</ul>
<h5 id="bypass_5">Bypass<a class="headerlink" href="#bypass_5" title="Permanent link">&para;</a></h5>
<ul>
<li>Again the bypass for this is to skip the function call with <code>NOP</code> or the method Galmeel Ali used<sup id="fnref:12"><a class="footnote-ref" href="#fn:12">12</a></sup>. </li>
</ul>
<h4 id="structured-exception-handling-seh">Structured Exception Handling (SEH)<a class="headerlink" href="#structured-exception-handling-seh" title="Permanent link">&para;</a></h4>
<h5 id="description16">Description<sup id="fnref:16"><a class="footnote-ref" href="#fn:16">16</a></sup><a class="headerlink" href="#description16" title="Permanent link">&para;</a></h5>
<ul>
<li>Microsoft Structured Exception Handling (SEH) is the native exception handling mechanism for Windows </li>
<li>It provides a single mechanism for the handling of kernel-mode and user-mode exceptions.</li>
<li>When no debugger is present, SEH handler will receive control of any errors. However, if debugger is present, the debugger will intercept the control after the <code>int 3h</code> instruction. </li>
</ul>
<h4 id="tls-callback">TLS Callback<a class="headerlink" href="#tls-callback" title="Permanent link">&para;</a></h4>
<h5 id="description_3">Description<a class="headerlink" href="#description_3" title="Permanent link">&para;</a></h5>
<ul>
<li>Thread Local Storage (TLS) Callbacks is a Windows mechanism that allows execution of arbitrary code on process and threads start and termination.</li>
<li>TLS Callbacks can be used to run some anti-debug code before main function (or other entry point). Thus anti-debug code can check for debugger before entry point is reached and do its anti-analysis routine. </li>
</ul>
<h4 id="software-breakpoint-detection">Software Breakpoint Detection<a class="headerlink" href="#software-breakpoint-detection" title="Permanent link">&para;</a></h4>
<h5 id="description17">Description<sup id="fnref:17"><a class="footnote-ref" href="#fn:17">17</a></sup><a class="headerlink" href="#description17" title="Permanent link">&para;</a></h5>
<ul>
<li>Breakpoints is an intentional stopping or pausing place in a program, put in place for debugging purposes.</li>
<li>Software breakpoints are usually generated by a call to the debug handle <code>int 3h</code>. The opcode for <code>int 3h</code> is <code>0xCC</code></li>
<li>To detect if a software breakpoint exists, malware can enumerate the number of <code>0xCC</code> bytes using the <code>repne scasb</code> instruction.</li>
<li>The malware can also have a function<sup id="fnref2:18"><a class="footnote-ref" href="#fn:18">18</a></sup> like below to check for <code>0xCC</code>.
   <div class="highlight"><pre><span></span><code><span class="kt">bool</span><span class="w"> </span><span class="nf">CheckForSpecificByte</span><span class="p">(</span><span class="n">BYTE</span><span class="w"> </span><span class="n">cByte</span><span class="p">,</span><span class="w"> </span><span class="n">PVOID</span><span class="w"> </span><span class="n">pMemory</span><span class="p">,</span><span class="w"> </span><span class="n">SIZE_T</span><span class="w"> </span><span class="n">nMemorySize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">PBYTE</span><span class="w"> </span><span class="n">pBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">PBYTE</span><span class="p">)</span><span class="n">pMemory</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="c1">// enumerate the memory location and compare with cByte </span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">SIZE_T</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Break on RET (0xC3) if we don&#39;t know the function&#39;s size</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(((</span><span class="n">nMemorySize</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">nMemorySize</span><span class="p">))</span><span class="w"> </span><span class="o">||</span>
<span class="w">            </span><span class="p">((</span><span class="n">nMemorySize</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">pBytes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0xC3</span><span class="p">)))</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pBytes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">cByte</span><span class="p">)</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span><span class="w"> </span><span class="nf">IsDebugged</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">PVOID</span><span class="w"> </span><span class="n">functionsToCheck</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">Function1</span><span class="p">,</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">Function2</span><span class="p">,</span>
<span class="w">        </span><span class="o">&amp;</span><span class="n">Function3</span><span class="p">,</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">funcAddr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">functionsToCheck</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">CheckForSpecificByte</span><span class="p">(</span><span class="mh">0xCC</span><span class="p">,</span><span class="w"> </span><span class="n">funcAddr</span><span class="p">))</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></li>
</ul>
<h5 id="bypass_6">Bypass<a class="headerlink" href="#bypass_6" title="Permanent link">&para;</a></h5>
<ul>
<li>The way to bypass this is to look for the function that is responsible for the enumeration and replace the return value. (Patching)</li>
</ul>
<h4 id="hardware-breakpoint-detection">Hardware Breakpoint Detection<a class="headerlink" href="#hardware-breakpoint-detection" title="Permanent link">&para;</a></h4>
<h5 id="description-18">Description <sup id="fnref:18"><a class="footnote-ref" href="#fn:18">18</a></sup><a class="headerlink" href="#description-18" title="Permanent link">&para;</a></h5>
<ul>
<li>Values in debug registers <code>DR0</code>, <code>DR1</code>,<code>DR2</code>,<code>DR3</code> can be retrieved using Win32 API <code>GetThreadContext</code></li>
<li>If thread context is non-zero, it may mean that the process is running under a debugger and a hardware breakpoint was set.</li>
<li>The code below is an example of how detection can be done.
   <div class="highlight"><pre><span></span><code><span class="kt">bool</span><span class="w"> </span><span class="nf">IsDebugged</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">CONTEXT</span><span class="w"> </span><span class="n">ctx</span><span class="p">;</span>
<span class="w">    </span><span class="n">ZeroMemory</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">CONTEXT</span><span class="p">));</span><span class="w"> </span>
<span class="w">    </span><span class="n">ctx</span><span class="p">.</span><span class="n">ContextFlags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CONTEXT_DEBUG_REGISTERS</span><span class="p">;</span><span class="w"> </span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">GetThreadContext</span><span class="p">(</span><span class="n">GetCurrentThread</span><span class="p">(),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">))</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">Dr0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">Dr1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">Dr2</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="n">Dr3</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></li>
</ul>
<h5 id="bypass_7">Bypass<a class="headerlink" href="#bypass_7" title="Permanent link">&para;</a></h5>
<ul>
<li>To bypass this, we will need to reset the value of the debug registers to 0 with another Win32API <code>SetThreadContext</code>.</li>
</ul>
<h4 id="trap-flag">Trap Flag<a class="headerlink" href="#trap-flag" title="Permanent link">&para;</a></h4>
<h5 id="description-20">Description <sup id="fnref:20"><a class="footnote-ref" href="#fn:20">20</a></sup><a class="headerlink" href="#description-20" title="Permanent link">&para;</a></h5>
<ul>
<li>Debugger will have the tendency to zero the <code>TRAP</code> Flag within the <code>EFLAGS</code>register.</li>
<li>Therefore the malware might set the <code>TRAP</code> flag to <code>1</code> to trigger an exception and have SEH handle the exception which will then lead it to the correct code. </li>
<li>Else, if a debugger is present, it will clear the <code>TRAP</code> flag which will then allow the program to step through and a possible exit function follows. </li>
</ul>
<h5 id="illustration-19">Illustration <sup id="fnref:19"><a class="footnote-ref" href="#fn:19">19</a></sup><a class="headerlink" href="#illustration-19" title="Permanent link">&para;</a></h5>
<p><img alt="Pasted image 20220608223132.png" src="../Media/Pasted%20image%2020220608223132.png" />
- From the above is the section of a crackme where the <code>TRAP</code> flag is used to check for debugger.
- We shall break the code into 4 parts
    1.  Over here as the comment has said SEH is installed. SEH is installed to catch the exception later on. <br><img alt="Pasted image 20220608224143.png" src="../Media/Pasted%20image%2020220608224143.png" />
    2. In this set of instructions, the <code>TRAP</code> flag is set to <code>1</code> <br><img alt="Pasted image 20220608224211.png" src="../Media/Pasted%20image%2020220608224211.png" />
    3.  If a debugger is present, it will step right through to the next instruction. And as we can see, this set of instructions will lead to a textbox saying <em>What the hell are you doing in my app with a debugger</em>  and followed by an <code>ExitProcess</code> call. <br><img alt="Pasted image 20220608224245.png" src="../Media/Pasted%20image%2020220608224245.png" />
    4. However, if a debugger is not present, it will raise an exception and SEH will handle the exception which will step to this part of the code where the actual process starts. <br><img alt="Pasted image 20220608224303.png" src="../Media/Pasted%20image%2020220608224303.png" /></p>
<h5 id="bypass_8">Bypass<a class="headerlink" href="#bypass_8" title="Permanent link">&para;</a></h5>
<ul>
<li>Set a breakpoint in the code which follows the check and run the program until the breakpoint. Find out where the entry point should be after the breakpoint and jump to it.</li>
</ul>
<h4 id="interrupts">Interrupts<a class="headerlink" href="#interrupts" title="Permanent link">&para;</a></h4>
<h5 id="description21">Description<sup id="fnref:21"><a class="footnote-ref" href="#fn:21">21</a></sup><a class="headerlink" href="#description21" title="Permanent link">&para;</a></h5>
<ul>
<li>Malware authors can intentionally call for an interrupt to check for the presence of a debugger. </li>
<li>The following interrupt calls can be used :<ul>
<li><code>int 3</code> </li>
<li><code>int 2C</code></li>
<li><code>int 2D</code></li>
<li><code>ICE</code></li>
</ul>
</li>
<li>Details of the mechanism of action of each interrupts can be found <a href="https://anti-debug.checkpoint.com/techniques/assembly.html">here</a>.</li>
<li>In general what is happening here is that these Interrupts will cause an exception to be raised. </li>
<li>When a debugger is present, all these exceptions caused by the interrupts will be bypassed by the debugger. </li>
<li>The anti-debug mechanism will be looking out for exceptions, and if there are no exceptions, when the interrupt is issued, debugger is assumed to be present.</li>
</ul>
<h5 id="bypass_9">Bypass<a class="headerlink" href="#bypass_9" title="Permanent link">&para;</a></h5>
<ul>
<li>Patch with <code>NOP</code>.</li>
</ul>
<h4 id="timing">Timing<a class="headerlink" href="#timing" title="Permanent link">&para;</a></h4>
<h5 id="description_4">Description<a class="headerlink" href="#description_4" title="Permanent link">&para;</a></h5>
<ul>
<li>Generally debugging tools require more time and effort to process instructions.</li>
<li>This will create fluctuation and slowness that is more than the computer's processing speed threshold which is a fixed value.</li>
<li>Thus the malware can read the time stamp of the computer multiple times and if it find irregularities, in the processing time, it will act like it detects a debugger. </li>
</ul>
<h3 id="anti-disassembly-techniques">Anti-Disassembly Techniques<a class="headerlink" href="#anti-disassembly-techniques" title="Permanent link">&para;</a></h3>
<ul>
<li>techniques used by malware authors to make crafted code or data in a program to cause disassembly analysis tools to produce an incorrect program listing.</li>
<li>Below is a list of common techniques employed</li>
</ul>
<table>
<thead>
<tr>
<th>Technique</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>API Obfuscation</td>
<td>- obfuscates the identifier names in  the code such as the or method names into random names.</td>
</tr>
<tr>
<td>Opcode Obfuscation</td>
<td>- decryption of sections of executables and code instructions, generating nonsensical  or hard to read opcode</td>
</tr>
<tr>
<td>Spaghetti Code</td>
<td>- source code that is unstructured and difficult-to- maintain</td>
</tr>
<tr>
<td>Control Flow Graph Flattening</td>
<td>- Control Flow Graph(CFG)flattening is done by breaking up the nested loops and if-else statements, hiding them as  large switch statement case wrapped inside the loop body.</td>
</tr>
<tr>
<td>Jump Instruction  with Same Target</td>
<td>- Combining <code>jz</code> and <code>jnz</code> to jump to the same target to produce an unconditional jump and confusing the  disassembler.</td>
</tr>
</tbody>
</table>
<h3 id="anti-vm-techniques">Anti-VM Techniques<a class="headerlink" href="#anti-vm-techniques" title="Permanent link">&para;</a></h3>
<ul>
<li>techniques used by malware author to detect virtual environments.</li>
<li>VMs keep some artifacts to indicate that it is a VM and not a physical machine and they could be files, registry keys, processes services and network device adapters.</li>
<li>Below are some common techniques used by malware author.</li>
</ul>
<h4 id="__cpuid"><code>__CPUID</code><a class="headerlink" href="#__cpuid" title="Permanent link">&para;</a></h4>
<h5 id="description_5">Description<a class="headerlink" href="#description_5" title="Permanent link">&para;</a></h5>
<ul>
<li><code>__CPUID</code> is a win32api to call the <code>CPUID</code> instruction set to get information about the processor.</li>
<li>Giving <code>__CPUID</code> with different <code>function_id</code> will give different details and the function IDs that is commonly used to enumerate the CPU information are 1 ,0 and 4000 0000.</li>
</ul>
<table>
<thead>
<tr>
<th><code>EAX</code> / <code>function_id</code> value</th>
<th>Return</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>- return Processor Info and Feature Bits,  essentially a rundown of various details  about the CPU.<br>  - On a physical machine, the 31st bit of  the returned <code>ECX</code> register will be 0,  while on a virtual machine it will be 1.</td>
</tr>
<tr>
<td>1</td>
<td>- return the CPU manufacturer-ID string,  a 12-character ASCII string that will  be stored in <code>EBX</code>, <code>EDX</code> and <code>ECX</code> (in that order).<br>  - On machines running on a physical Intel or AMD CPU  this string will be “GenuineIntel” or “AuthenticAMD”,  respectively.<br>  - On machines running off of Microsoft’s Hyper-V or  VMware this string will be “Microsoft HV” or “VMwareVMware”.</td>
</tr>
<tr>
<td>4000 0000</td>
<td>- returns virtualisation vendor string saved in <code>EAX</code>, <code>ECX</code> and <code>EDX</code></td>
</tr>
</tbody>
</table>
<h5 id="bypass_10">Bypass<a class="headerlink" href="#bypass_10" title="Permanent link">&para;</a></h5>
<ul>
<li>VM vendors usually allow the host machine to alter the CPUID and CPU features of the virtual machine.</li>
<li>For VMware, we can find the <code>.vmx</code> file and add the following line : 
   <div class="highlight"><pre><span></span><code>cpuid.1.ecx=&#39;0---:----:----:----:----:----:----:---&#39;
</code></pre></div></li>
<li>subsequently restart the VM.</li>
</ul>
<h4 id="mmx-instruction-set"><code>MMX</code> Instruction Set<a class="headerlink" href="#mmx-instruction-set" title="Permanent link">&para;</a></h4>
<h5 id="description_6">Description<a class="headerlink" href="#description_6" title="Permanent link">&para;</a></h5>
<ul>
<li>The <code>MMX</code> Instruction set is used for faster processing of graphics. </li>
<li>Usually VMs do not support this instruction set, hence the absence of this instruction set could indicate that the malware is in a VM environment.</li>
</ul>
<h4 id="vmware-magic-number">VMWare 'Magic Number'<a class="headerlink" href="#vmware-magic-number" title="Permanent link">&para;</a></h4>
<h5 id="description22">Description<sup id="fnref:22"><a class="footnote-ref" href="#fn:22">22</a></sup><a class="headerlink" href="#description22" title="Permanent link">&para;</a></h5>
<ul>
<li>VMware uses a virtual I/O port for communication between guest and host.</li>
<li>This is to allow afor things like copy-paste between host and guest systems</li>
</ul>
<h5 id="bypass-23">Bypass <sup id="fnref:23"><a class="footnote-ref" href="#fn:23">23</a></sup><a class="headerlink" href="#bypass-23" title="Permanent link">&para;</a></h5>
<ol>
<li>Look for instructions like <code>sidt</code>, <code>sgdt</code> and <code>sldr</code> during debugging and replace the Anti-Vm code with <code>NOP</code>.</li>
<li>Not install Vmware tools </li>
<li>Create multiprocessor VMs. </li>
<li>Red Pill testa<sup id="fnref:25"><a class="footnote-ref" href="#fn:25">25</a></sup> usually work only on single processor machine.</li>
<li>This can be mitigated by changing the settings of VMware with the following settings: 
   <div class="highlight"><pre><span></span><code>isolation.tools.getPtrLocation.disable = &quot;TRUE&quot;
isolation.tools.setPtrLocation.disable = &quot;TRUE&quot;
isolation.tools.setVersion.disable = &quot;TRUE&quot;
isolation.tools.getVersion.disable = &quot;TRUE&quot;
monitor_control.disable_directexec = &quot;TRUE&quot;
monitor_control.disable_chksimd = &quot;TRUE&quot;
monitor_control.disable_ntreloc = &quot;TRUE&quot;
monitor_control.disable_selfmod = &quot;TRUE&quot;
monitor_control.disable_reloc = &quot;TRUE&quot;
monitor_control.disable_btinout = &quot;TRUE&quot;
monitor_control.disable_btmemspace = &quot;TRUE&quot;
monitor_control.disable_btpriv = &quot;TRUE&quot;
monitor_control.disable_btseg = &quot;TRUE&quot;
</code></pre></div></li>
</ol>
<h4 id="known-mac-address">Known MAC Address<a class="headerlink" href="#known-mac-address" title="Permanent link">&para;</a></h4>
<h5 id="description_7">Description<a class="headerlink" href="#description_7" title="Permanent link">&para;</a></h5>
<ul>
<li>Malware can determine the presence of VM by checking the prefix of the MAC address.</li>
</ul>
<table>
<thead>
<tr>
<th>Vm Brand</th>
<th>MAC Address Prefix</th>
</tr>
</thead>
<tbody>
<tr>
<td>VMware</td>
<td>00:05:69, 00:0C:29,<br> 00:1C:14, 00:50:56, 08:00:27</td>
</tr>
<tr>
<td>VirtualBox</td>
<td>08:00:27</td>
</tr>
<tr>
<td>Hyper-V</td>
<td>00:03:FF</td>
</tr>
</tbody>
</table>
<h4 id="registry-key">Registry Key<a class="headerlink" href="#registry-key" title="Permanent link">&para;</a></h4>
<h5 id="description_8">Description<a class="headerlink" href="#description_8" title="Permanent link">&para;</a></h5>
<ul>
<li>Some registry keys can indicate the presence of virtualisation software.</li>
<li>Malware can be made to enumerate for these registry keys.</li>
</ul>
<table>
<thead>
<tr>
<th>VM Brand</th>
<th>Registry Keys</th>
</tr>
</thead>
<tbody>
<tr>
<td>Generic</td>
<td>- HKEY_LOCAL_MACHINE\HARDWARE\DEVICEMAP\Scsi\Scsi <br>  - HKEY_LOCAL_MACHINE\HARDWARE\DESCRIPTION\System\SystemBiosVersion</td>
</tr>
<tr>
<td>VMware</td>
<td>- HKEY_CURRENT_USER\Software\VMware Inc <br> - HKEY_LOCAL_MACHINE\SOFTWARE\VMware Inc <br> - HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\SCSI\VMWARE<br> - HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VMware</td>
</tr>
<tr>
<td>VirtualBox</td>
<td>- HKEY_LOCAL_MACHINE\HARDWARE\ACPI\DSDT\VBOX<br> - HKEY_LOCAL_MACHINE\HARDWARE\ACPI\FADT\VBOX<br> - HKEY_LOCAL_MACHINE\HARDWARE\ACPI\RSDT\VBOX<br> - HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Vbox<br> - HKEY_LOCAL_MACHINE\SOFTWARE\Oracle\VirtualBox Guest Additions</td>
</tr>
</tbody>
</table>
<h4 id="checking-for-vm-processes-files-services">Checking for VM Processes, Files &amp; Services<a class="headerlink" href="#checking-for-vm-processes-files-services" title="Permanent link">&para;</a></h4>
<h5 id="description-24">Description <sup id="fnref:24"><a class="footnote-ref" href="#fn:24">24</a></sup><a class="headerlink" href="#description-24" title="Permanent link">&para;</a></h5>
<ul>
<li>VMs generally runs some processes and services or produce some file artefacts which are indicative of the use of VM.</li>
<li>These information can be obtained using Wni32API, WMIC or CMD</li>
</ul>
<table>
<thead>
<tr>
<th>VM Brand</th>
<th>Processes</th>
</tr>
</thead>
<tbody>
<tr>
<td>VMware</td>
<td>- VMwareuser.exe <br> - Vmtoolsd.exe <br> - Vmwaretrat.exe <br> - VGAuthService.exe <br> - vmacthlp.exe</td>
</tr>
<tr>
<td>VirtualBox</td>
<td>- vboxservice.exe <br> - vboxtray.exe</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>VM Brand</th>
<th>Services</th>
</tr>
</thead>
<tbody>
<tr>
<td>VMware</td>
<td>- VMTools <br> - vmvss <br> - VGAuthService <br> - VMware Physical Disk Helper Service</td>
</tr>
<tr>
<td>VirtualBox</td>
<td>- VBoxService</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>VM Brand</th>
<th>Files</th>
</tr>
</thead>
<tbody>
<tr>
<td>VMware</td>
<td>- C:\Windows\System32\drivers\vmhgfs.sys <br> - C:\Windows\System32\drivers\vmmemctl.sys<br> - C:\Windows\System32\drivers\vmmouse.sys<br> - C:\Windows\System32\drivers\vmrawdsk.sys</td>
</tr>
<tr>
<td>VirtualBox</td>
<td>- C:\Windows\System32\drivers\VBoxMouse.sys<br> - C:\Windows\System32\drivers\VBoxGuest.sys<br> - C:\Windows\System32\drivers\VBoxSF.sys<br> - C:\Windows\System32\drivers\VBoxVideo.sys</td>
</tr>
</tbody>
</table>
<h2 id="process-hollowing">Process Hollowing<a class="headerlink" href="#process-hollowing" title="Permanent link">&para;</a></h2>
<ul>
<li>Is a process in which the malware unmaps or 'hollows' out the code of the legitimate process from memory and overwrites the memory space of the victim process with its malicious code.</li>
<li>Content of the PEB (Process Environment Block) and path of the process being hollowed remains the same but the actual data and code of the process are changed thus avoiding detection by unsopisticated signature-based EDR/AV. </li>
</ul>
<h3 id="illustration-of-proccess-hollowing">Illustration of Proccess Hollowing<a class="headerlink" href="#illustration-of-proccess-hollowing" title="Permanent link">&para;</a></h3>
<p><pre class="mermaid"><code>graph TD;

subgraph Process
A[1. Malware creates a new process in&lt;br&gt; suspended state to host malicious code]--&gt;B[2. Malware then unmap the legitimate&lt;br&gt; process content and replaces &lt;br&gt;the space with its malicious payload &lt;br&gt; which can come from the malware process&lt;br&gt; or from a file stored in disk.]

B--&gt;C[3. The loader will allocate new memory &lt;br&gt;space for malware with all permissions: &lt;br&gt;read, write and execute and subsequently &lt;br&gt; write the malware's section into the target &lt;br&gt; process memory space]

C--&gt;D[4. The malware then uses SetThreadContext &lt;br&gt; to determine the entry point of the &lt;br&gt; new malicious code section which has &lt;br&gt;been written.]

D--&gt;E[5. Malware resumes the suspended thread]
end

subgraph API Calls
A1[CreateProcess]--&gt;B1[NtUnmapViewOfSection/&lt;br&gt;ZwUnmapViewOfSection]--&gt;C1[VirtualAllocEx&lt;br&gt;WriteProcessMemory]--&gt;D1[SetThreadContext]--&gt;E1[ResumeThread]
end</code></pre>
- in Step 3 rather than writing into the section to be used using <code>WriteProcessMemory</code>, stealthier malware could have created a new section and make the process map to the new section created.
- In Step 4 some malware could modify the entry point instead of using <code>SetThreadContext</code> to determine the entry point.</p>
<h3 id="using-api-monitor-to-observe-process-hollowing">Using API Monitor to Observe Process Hollowing<a class="headerlink" href="#using-api-monitor-to-observe-process-hollowing" title="Permanent link">&para;</a></h3>
<h4 id="set-up-monitoring">Set-Up Monitoring<a class="headerlink" href="#set-up-monitoring" title="Permanent link">&para;</a></h4>
<ul>
<li>Run API Monitor as <code>Administrator</code>
<img alt="Pasted image 20220601153141.png" src="../Media/Pasted%20image%2020220601153141.png" /></li>
<li>
<p>Set filter to filter for :</p>
<ol>
<li><code>CreateProcessA</code> &amp; <code>CreateProcessW</code> </li>
<li><code>NtQueryInformationProcess</code>, <code>NtUnmapViewOfSection</code>, <code>NtCreateSection</code>, <code>NtMapViewOfSection</code>, </li>
<li><code>VirtualProtect</code>,<code>VirtualAlloc</code> , <code>VirtualAllocEx</code>,  <code>ReadProcessMemory</code> &amp; <code>WriteProcessMemory</code></li>
<li><code>SetThreadContext</code>, <code>GetProcAddress</code></li>
<li><code>NtResumeThread</code> &amp; <code>ResumeThread</code></li>
</ol>
</li>
<li>
<p>Filter can be set by checking the API call filter like below :
<img alt="Pasted image 20220601151439.png" src="../Media/Pasted%20image%2020220601151439.png" /></p>
</li>
<li>Breakpoints can be set like below to get alert when certain APIs are called like below :
<img alt="Pasted image 20220601151621.png" src="../Media/Pasted%20image%2020220601151621.png" /></li>
</ul>
<h4 id="specify-application-to-monitor">Specify Application to Monitor<a class="headerlink" href="#specify-application-to-monitor" title="Permanent link">&para;</a></h4>
<ul>
<li>Can be done by either clicking here
<img alt="Pasted image 20220601152536.png" src="../Media/Pasted%20image%2020220601152536.png" />
or
<img alt="Pasted image 20220601152601.png" src="../Media/Pasted%20image%2020220601152601.png" /></li>
</ul>
<h4 id="before-running">Before Running<a class="headerlink" href="#before-running" title="Permanent link">&para;</a></h4>
<p><img alt="Pasted image 20220601152717.png" src="../Media/Pasted%20image%2020220601152717.png" /></p>
<blockquote>
<p>Process --&gt; Executable to monitor </p>
<p>Arguments --&gt; Arguments/Parameters the executable will need</p>
</blockquote>
<h4 id="debugging">Debugging<a class="headerlink" href="#debugging" title="Permanent link">&para;</a></h4>
<ul>
<li>Alerts Created
<img alt="Pasted image 20220601152927.png" src="../Media/Pasted%20image%2020220601152927.png" /></li>
<li>Recorded API Calls
    <img alt="Pasted image 20220601153339.png" src="../Media/Pasted%20image%2020220601153339.png" /></li>
</ul>
<hr />
<h2 id="footnote">Footnote<a class="headerlink" href="#footnote" title="Permanent link">&para;</a></h2>
<h4 id="anti-debug">Anti-Debug<a class="headerlink" href="#anti-debug" title="Permanent link">&para;</a></h4>
<h4 id="anti-vm">Anti-VM<a class="headerlink" href="#anti-vm" title="Permanent link">&para;</a></h4>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>(https://docs.microsoft.com/en-us/windows/win32/api/debugapi/nf-debugapi-isdebuggerpresent)&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>(https://en.wikipedia.org/wiki/Process_Environment_Block)&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>(https://reverseengineering.stackexchange.com/questions/16983/bypass-isdebuggerpresent)&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>(https://docs.microsoft.com/en-us/windows/win32/api/debugapi/nf-debugapi-checkremotedebuggerpresent)&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:5">
<p>(https://oxhat.blogspot.com/2017/10/Anti-Reverse-Engineering-CheckRemoteDebuggerPresentAPI.html)&#160;<a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:6">
<p>(https://docs.microsoft.com/en-us/windows/win32/api/handleapi/nf-handleapi-closehandle)&#160;<a class="footnote-backref" href="#fnref:6" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn:7">
<p>(https://docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntclose)&#160;<a class="footnote-backref" href="#fnref:7" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
<li id="fn:8">
<p>(https://guidedhacking.com/threads/anti-debugging-tricks-%E2%80%93-closehandle-debugger-detection.14468/)&#160;<a class="footnote-backref" href="#fnref:8" title="Jump back to footnote 8 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:8" title="Jump back to footnote 8 in the text">&#8617;</a></p>
</li>
<li id="fn:9">
<p>(https://docs.microsoft.com/en-us/previous-versions/ms960613(v=msdn.10))&#160;<a class="footnote-backref" href="#fnref:9" title="Jump back to footnote 9 in the text">&#8617;</a></p>
</li>
<li id="fn:10">
<p>(https://docs.microsoft.com/en-us/windows/win32/learnwin32/what-is-a-window-)&#160;<a class="footnote-backref" href="#fnref:10" title="Jump back to footnote 10 in the text">&#8617;</a></p>
</li>
<li id="fn:11">
<p>(https://github.com/sloppey/FindWindowA-Bypass)&#160;<a class="footnote-backref" href="#fnref:11" title="Jump back to footnote 11 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:11" title="Jump back to footnote 11 in the text">&#8617;</a></p>
</li>
<li id="fn:12">
<p>https://malgamy.github.io/revese%20enginnering/Anti-debugging-and-anti-tracing-techniques5/&#160;<a class="footnote-backref" href="#fnref:12" title="Jump back to footnote 12 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:12" title="Jump back to footnote 12 in the text">&#8617;</a></p>
</li>
<li id="fn:13">
<p>https://www.anti-reversing.com/debugger-detection-using-outputdebugstring-seh/&#160;<a class="footnote-backref" href="#fnref:13" title="Jump back to footnote 13 in the text">&#8617;</a></p>
</li>
<li id="fn:14">
<p>https://unprotect.it/technique/isdebugged-flag/&#160;<a class="footnote-backref" href="#fnref:14" title="Jump back to footnote 14 in the text">&#8617;</a></p>
</li>
<li id="fn:15">
<p>https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=230d68b2-c80f-4436-9c09-ff84d049da33&amp;CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&amp;tab=librarydocuments&#160;<a class="footnote-backref" href="#fnref:15" title="Jump back to footnote 15 in the text">&#8617;</a></p>
</li>
<li id="fn:16">
<p>https://0xpat.github.io/Malware_development_part_3/&#160;<a class="footnote-backref" href="#fnref:16" title="Jump back to footnote 16 in the text">&#8617;</a></p>
</li>
<li id="fn:17">
<p>https://www.apriorit.com/dev-blog/367-anti-reverse-engineering-protection-techniques-to-use-before-releasing-software&#160;<a class="footnote-backref" href="#fnref:17" title="Jump back to footnote 17 in the text">&#8617;</a></p>
</li>
<li id="fn:18">
<p>https://anti-debug.checkpoint.com/techniques/process-memory.html#software-breakpoints&#160;<a class="footnote-backref" href="#fnref:18" title="Jump back to footnote 18 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:18" title="Jump back to footnote 18 in the text">&#8617;</a></p>
</li>
<li id="fn:19">
<p>https://leons.im/posts/anti-debug-with-trap-flag-register/&#160;<a class="footnote-backref" href="#fnref:19" title="Jump back to footnote 19 in the text">&#8617;</a></p>
</li>
<li id="fn:20">
<p>https://anti-debug.checkpoint.com/techniques/assembly.html#popf_and_trap_flag&#160;<a class="footnote-backref" href="#fnref:20" title="Jump back to footnote 20 in the text">&#8617;</a></p>
</li>
<li id="fn:21">
<p>https://resources.infosecinstitute.com/topic/anti-disassembly-anti-debugging-and-anti-vm/&#160;<a class="footnote-backref" href="#fnref:21" title="Jump back to footnote 21 in the text">&#8617;</a></p>
</li>
<li id="fn:22">
<p>https://brundlelab.wordpress.com/2012/10/21/detecting-vmware/&#160;<a class="footnote-backref" href="#fnref:22" title="Jump back to footnote 22 in the text">&#8617;</a></p>
</li>
<li id="fn:23">
<p>https://sganiere.wordpress.com/2012/11/20/malware-anti-vm-technics/&#160;<a class="footnote-backref" href="#fnref:23" title="Jump back to footnote 23 in the text">&#8617;</a></p>
</li>
<li id="fn:24">
<p>https://www.deepinstinct.com/blog/malware-evasion-techniques-part-2-anti-vm-blog&#160;<a class="footnote-backref" href="#fnref:24" title="Jump back to footnote 24 in the text">&#8617;</a></p>
</li>
<li id="fn:25">
<p>https://unprotect.it/technique/sidt-red-pill/&#160;<a class="footnote-backref" href="#fnref:25" title="Jump back to footnote 25 in the text">&#8617;</a></p>
</li>
</ol>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.81fa17fe.min.js"></script>
      
    
  </body>
</html>