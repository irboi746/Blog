
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../Burp_Academy/Practitioner/SQL%20Injection%20UNION%20Attack/">
      
      
        <link rel="next" href="../TISC%202022%20%282%29/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.8">
    
    
      
        <title>CSIT TISC 2022 (1) - irboi746's space</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4b4a2bd9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#csit-tisc-2022-1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="irboi746&#39;s space" class="md-header__button md-logo" aria-label="irboi746's space" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            irboi746's space
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CSIT TISC 2022 (1)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="irboi746&#39;s space" class="md-nav__button md-logo" aria-label="irboi746's space" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    irboi746's space
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Burp Academy
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Burp Academy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Apprentice
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Apprentice
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Burp_Academy/Apprentice/Access%20Control%20Vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Burp_Academy/Apprentice/Authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Burp_Academy/Apprentice/Business%20Logic%20Vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Business Logic Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Burp_Academy/Apprentice/CSRF%2C%20Clickjacking%20and%20CORS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSRF, Clickjacking and CORS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Burp_Academy/Apprentice/Cross%20Site%20Scripting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Site Scripting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Burp_Academy/Apprentice/DOM-based%20XSS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DOM based XSS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Burp_Academy/Apprentice/HTTP%20Host%20Header%20Attacks%20and%20File%20Upload%20Vulnerabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTP Host Header Attacks & File Upload Vulnerabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Burp_Academy/Apprentice/Information%20Disclosure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Information Disclosure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Burp_Academy/Apprentice/JWT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JWT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Burp_Academy/Apprentice/Other%20Labs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Other Labs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Burp_Academy/Apprentice/SQL%20Injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Burp_Academy/Apprentice/XXE%20and%20SSRF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XXE and SSRF
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Practitioner
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Practitioner
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Burp_Academy/Practitioner/SQL%20Injection%20DB%20Enumeration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection DB Enumeration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Burp_Academy/Practitioner/SQL%20Injection%20UNION%20Attack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Injection UNION Attack
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CTF
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            CTF
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    CSIT TISC 2022 (1)
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    CSIT TISC 2022 (1)
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#level-1-slay-the-dragon" class="md-nav__link">
    Level 1 : Slay The Dragon
  </a>
  
    <nav class="md-nav" aria-label="Level 1 : Slay The Dragon">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon" class="md-nav__link">
    Recon
  </a>
  
    <nav class="md-nav" aria-label="Recon">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-page" class="md-nav__link">
    Main Page
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fight-boss" class="md-nav__link">
    Fight Boss
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mine-gold" class="md-nav__link">
    Mine Gold
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go-shopping" class="md-nav__link">
    Go Shopping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#battleeventpy" class="md-nav__link">
    battleevent.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#battleservicepy" class="md-nav__link">
    battleservice.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commandpy" class="md-nav__link">
    command.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#workeventpy" class="md-nav__link">
    workevent.py
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation" class="md-nav__link">
    Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#level-2-leaky-matrices" class="md-nav__link">
    Level 2 : Leaky Matrices
  </a>
  
    <nav class="md-nav" aria-label="Level 2 : Leaky Matrices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-protocol" class="md-nav__link">
    Understanding Protocol
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation_1" class="md-nav__link">
    Exploitation
  </a>
  
    <nav class="md-nav" aria-label="Exploitation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leaking-secret_key" class="md-nav__link">
    Leaking SECRET_KEY
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sending-payload-challenges" class="md-nav__link">
    Sending Payload Challenges
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#level-3-patient0-part-1" class="md-nav__link">
    Level 3 : Patient0 - Part 1
  </a>
  
    <nav class="md-nav" aria-label="Level 3 : Patient0 - Part 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon_1" class="md-nav__link">
    Recon
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#level-3-patient-0-part-2" class="md-nav__link">
    Level 3 : PATIENT 0 - Part 2
  </a>
  
    <nav class="md-nav" aria-label="Level 3 : PATIENT 0 - Part 2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hints" class="md-nav__link">
    Hints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon_2" class="md-nav__link">
    Recon
  </a>
  
    <nav class="md-nav" aria-label="Recon">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#messagepng" class="md-nav__link">
    message.png
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#messagepng-ads" class="md-nav__link">
    message.png ADS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brokenpdf" class="md-nav__link">
    broken.pdf
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unlocking-outer" class="md-nav__link">
    Unlocking Outer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../TISC%202022%20%282%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSIT TISC 2022 (2)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Flareon22
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Flareon22
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Flareon22/FlareOn_22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flareon-22
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dev
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Dev
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Java
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Java
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev/Java/Burp%20Extension%20-%20GUI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Burp Extension - GUI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev/Java/Burp%20Extension%20-%20Hello%20World/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Burp Extension - Hello World
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev/Java/Burp%20Extension%20-%20README/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Burp Extension   README
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Javascript
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Javascript
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev/Javascript/Node.js/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node.js
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev/Javascript/Node.js_Projects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NodeJS Projects
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev/Python/Web%20Automation%20Cheatsheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Web Automation Cheatsheet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Malware Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Malware Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware_Analysis/Notes/File_Identification%26Classification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Identification and Classification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware_Analysis/Notes/Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware_Analysis/Notes/Windows%20Obfuscation%20Techniques/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows Obfuscation Techniques
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Practical Malware Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Practical Malware Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware_Analysis/Practical_Malware_Analysis/Chapter%200/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter 0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware_Analysis/Practical_Malware_Analysis/Chapter%201/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware_Analysis/Practical_Malware_Analysis/Chapter%203/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter 3
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    OWASP Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            OWASP Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../OWASP_Labs/Generic%20University/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generic University
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../OWASP_Labs/crAPI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    crAPI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PG
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            PG
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../PG/Linux%20-%20Cassios/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cassios
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    RE101
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            RE101
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../RE101/3.%20Simple%20Lambdas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Simple Lambdas
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Random Thoughts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Random Thoughts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Random_Thoughts/010622-1824/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Pentest or... not?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Random_Thoughts/Building%20a%20Personal%20Containerized%20Web%20Pentest%20Lab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building a Personal Containerized Web Pentest Lab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Random_Thoughts/Password%20Management%20with%20Self-Hosted%20KeeWeb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Password Management with Self-Hosted KeeWeb
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#level-1-slay-the-dragon" class="md-nav__link">
    Level 1 : Slay The Dragon
  </a>
  
    <nav class="md-nav" aria-label="Level 1 : Slay The Dragon">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon" class="md-nav__link">
    Recon
  </a>
  
    <nav class="md-nav" aria-label="Recon">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-page" class="md-nav__link">
    Main Page
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fight-boss" class="md-nav__link">
    Fight Boss
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mine-gold" class="md-nav__link">
    Mine Gold
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go-shopping" class="md-nav__link">
    Go Shopping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#battleeventpy" class="md-nav__link">
    battleevent.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#battleservicepy" class="md-nav__link">
    battleservice.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commandpy" class="md-nav__link">
    command.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#workeventpy" class="md-nav__link">
    workevent.py
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation" class="md-nav__link">
    Exploitation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#level-2-leaky-matrices" class="md-nav__link">
    Level 2 : Leaky Matrices
  </a>
  
    <nav class="md-nav" aria-label="Level 2 : Leaky Matrices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#understanding-protocol" class="md-nav__link">
    Understanding Protocol
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation_1" class="md-nav__link">
    Exploitation
  </a>
  
    <nav class="md-nav" aria-label="Exploitation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leaking-secret_key" class="md-nav__link">
    Leaking SECRET_KEY
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sending-payload-challenges" class="md-nav__link">
    Sending Payload Challenges
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#level-3-patient0-part-1" class="md-nav__link">
    Level 3 : Patient0 - Part 1
  </a>
  
    <nav class="md-nav" aria-label="Level 3 : Patient0 - Part 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recon_1" class="md-nav__link">
    Recon
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#level-3-patient-0-part-2" class="md-nav__link">
    Level 3 : PATIENT 0 - Part 2
  </a>
  
    <nav class="md-nav" aria-label="Level 3 : PATIENT 0 - Part 2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hints" class="md-nav__link">
    Hints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recon_2" class="md-nav__link">
    Recon
  </a>
  
    <nav class="md-nav" aria-label="Recon">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#messagepng" class="md-nav__link">
    message.png
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#messagepng-ads" class="md-nav__link">
    message.png ADS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brokenpdf" class="md-nav__link">
    broken.pdf
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unlocking-outer" class="md-nav__link">
    Unlocking Outer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="csit-tisc-2022-1">CSIT TISC 2022 (1)<a class="headerlink" href="#csit-tisc-2022-1" title="Permanent link">&para;</a></h1>
<h2 id="level-1-slay-the-dragon">Level 1 : Slay The Dragon<a class="headerlink" href="#level-1-slay-the-dragon" title="Permanent link">&para;</a></h2>
<p>The recently launched online RPG game "Slay The Dragon" has been hot topic in the online gaming community of late, due to a seemingly impossible final boss. Amongst the multiple tirades against the forementioned boss, much controversy has been brewing due to rumors of the game being a recruitment campaign for PALINDROME, the cybercriminal organisation responsible for recent cyberattacks on Singapore's critical infrastructure.</p>
<p>You are tasked to find a way to beat (hack) the game and provide us with the flag (a string in the format TISC{xxx}) that would be displayed after beating the final boss. Your success is critical to ensure the safety of Singapore's cyberspace, as it would allow us to send more undercover operatives to infiltrate PALINDROME.</p>
<p>To aid in your efforts, we have managed to obtain the source code of the game for you. We look forward to your success! </p>
<h3 id="recon">Recon<a class="headerlink" href="#recon" title="Permanent link">&para;</a></h3>
<ul>
<li>In the initial stage of my recon, I will attempt to map out what the visible functions are by connecting directly and playing the game.</li>
</ul>
<div class="highlight"><pre><span></span><code>./client_linux_x64 --host chal00bq3ouweqtzva9xcobep6spl5m75fucey.ctf.sg --port 18261
</code></pre></div>
<h4 id="main-page">Main Page<a class="headerlink" href="#main-page" title="Permanent link">&para;</a></h4>
<ul>
<li>From the Main Page Below, we can see that there is only 3 functions we can do : <a href="#fight-boss">#Fight Boss</a>, <a href="#mine-gold">#Mine Gold</a> and <a href="#go-shopping">#Go Shopping</a>.</li>
<li>We can also see the Player stats from the Main Page.</li>
</ul>
<p><img alt="Pasted image 20220826222430.png" src="../Media/Pasted%20image%2020220826222430.png" /></p>
<h4 id="fight-boss">Fight Boss<a class="headerlink" href="#fight-boss" title="Permanent link">&para;</a></h4>
<ul>
<li>So I shall attempt to fight the boss straight away and I realised that there is an impossible boss to beat "Dragon".</li>
</ul>
<p><img alt="Pasted image 20220826222452.png" src="../Media/Pasted%20image%2020220826222452.png" />
<img alt="Pasted image 20220826222821.png" src="../Media/Pasted%20image%2020220826222821.png" />
<img alt="Pasted image 20220826232930.png" src="../Media/Pasted%20image%2020220826232930.png" /></p>
<p><img alt="Pasted image 20220829150133.png" src="../Media/Pasted%20image%2020220829150133.png" />
<img alt="Pasted image 20220829150209.png" src="../Media/Pasted%20image%2020220829150209.png" />
<img alt="Pasted image 20220829150120.png" src="../Media/Pasted%20image%2020220829150120.png" /></p>
<h4 id="mine-gold">Mine Gold<a class="headerlink" href="#mine-gold" title="Permanent link">&para;</a></h4>
<ul>
<li>In the Mine Gold function I find out that after every "Mining" activity, the amount of Gold </li>
</ul>
<p><img alt="Pasted image 20220826222632.png" src="../Media/Pasted%20image%2020220826222632.png" /></p>
<p><img alt="Pasted image 20220826222546.png" src="../Media/Pasted%20image%2020220826222546.png" />
<img alt="Pasted image 20220826222559.png" src="../Media/Pasted%20image%2020220826222559.png" /></p>
<h4 id="go-shopping">Go Shopping<a class="headerlink" href="#go-shopping" title="Permanent link">&para;</a></h4>
<p><img alt="Pasted image 20220826222706.png" src="../Media/Pasted%20image%2020220826222706.png" /></p>
<h4 id="battleeventpy">battleevent.py<a class="headerlink" href="#battleeventpy" title="Permanent link">&para;</a></h4>
<h4 id="battleservicepy">battleservice.py<a class="headerlink" href="#battleservicepy" title="Permanent link">&para;</a></h4>
<h4 id="commandpy">command.py<a class="headerlink" href="#commandpy" title="Permanent link">&para;</a></h4>
<p><img alt="Pasted image 20220829150803.png" src="../Media/Pasted%20image%2020220829150803.png" /></p>
<h4 id="workeventpy">workevent.py<a class="headerlink" href="#workeventpy" title="Permanent link">&para;</a></h4>
<p><img alt="Pasted image 20220826233015.png" src="../Media/Pasted%20image%2020220826233015.png" /></p>
<h3 id="exploitation">Exploitation<a class="headerlink" href="#exploitation" title="Permanent link">&para;</a></h3>
<ul>
<li>Therefore from the above code, we can see that in battleservice.py has a function <code>__compute_battle_outcome()</code> which will iterate through the variable <code>command</code> and count the number of <code>BOSS_ATTACK</code>, <code>ATTACK</code> and <code>HEAL</code>. </li>
<li>From Line 28 of <code>battleservice.py</code> <code>self.history.log_commands_from_str(self.server.recv_command_str())</code> we know that the server receives the command sent by the client as string and these commands are interpreted in the file <code>command.py</code> which is within the <code>/src/core/models</code></li>
<li>Hence all that we need to do is to send 100 "ATTACK" strings in one <code>Command.ATTACK</code> and we will be able to beat the last boss - "Dragon". </li>
<li>This can be done by modifying the <code>ATTACK</code> variable in the <code>Command()</code> class like below.</li>
</ul>
<p><img alt="Pasted image 20220829151730.png" src="../Media/Pasted%20image%2020220829151730.png" /></p>
<ul>
<li>Next we will need to modify battleevent.py accordingly so that the number of "ATTACKs" done will be reflected on client side which will then be validated.</li>
</ul>
<p><img alt="Pasted image 20220829152358.png" src="../Media/Pasted%20image%2020220829152358.png" /></p>
<ul>
<li>Now we will proceed to fighting the last boss and as can be seen, because we overpowered the previous bosses, our health remains full.</li>
</ul>
<p><img alt="Pasted image 20220829152500.png" src="../Media/Pasted%20image%2020220829152500.png" /></p>
<ul>
<li>From below, we won the final boss and we got out flag!</li>
</ul>
<p><img alt="Pasted image 20220829152553.png" src="../Media/Pasted%20image%2020220829152553.png" /></p>
<h2 id="level-2-leaky-matrices">Level 2 : Leaky Matrices<a class="headerlink" href="#level-2-leaky-matrices" title="Permanent link">&para;</a></h2>
<p>Looks like PALINDROME implemented their own authentication protocol and cryptosystem to provide a secure handshake between any 2 services or devices. It does not look secure to us, can you take a look at what we have got?</p>
<h3 id="understanding-protocol">Understanding Protocol<a class="headerlink" href="#understanding-protocol" title="Permanent link">&para;</a></h3>
<ul>
<li>The three main takeaways are as below.</li>
</ul>
<p><img alt="Pasted image 20220829153647.png" src="../Media/Pasted%20image%2020220829153647.png" />
<img alt="Pasted image 20220829153526.png" src="../Media/Pasted%20image%2020220829153526.png" />
<img alt="Pasted image 20220829153506.png" src="../Media/Pasted%20image%2020220829153506.png" /></p>
<h3 id="exploitation_1">Exploitation<a class="headerlink" href="#exploitation_1" title="Permanent link">&para;</a></h3>
<ul>
<li>Hence the secret keys can be leaked in the "Challenge Me" phase, where we will have to reverse the <code>AND</code> operation first then reverse the matrix multiplication with the response and challenge to obtain the secret.</li>
</ul>
<h4 id="leaking-secret_key">Leaking SECRET_KEY<a class="headerlink" href="#leaking-secret_key" title="Permanent link">&para;</a></h4>
<ul>
<li>Basing on the image of the sample implementation, we copy the important functions to test the properties of matrix.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">sysout</span><span class="p">(</span><span class="n">fstr</span><span class="p">):</span>
   <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fstr</span><span class="p">)</span>
   <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">vectostr</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
   <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">strtovec</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">)</span>

<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
   <span class="nb">print</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">)</span>

   <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Challenge Me&quot;</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
      <span class="n">input_vec</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Challenge Me #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> &lt;-- &quot;</span><span class="p">)</span>
      <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_vec</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span>
      <span class="k">assert</span> <span class="n">input_vec</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">input_vec</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span>
      <span class="n">input_vec</span> <span class="o">=</span> <span class="n">strtovec</span><span class="p">(</span><span class="n">input_vec</span><span class="p">)</span>
      <span class="c1">#print(input_vec) </span>
      <span class="n">output_vec</span> <span class="o">=</span> <span class="p">(</span><span class="n">SECRET_KEY</span> <span class="o">@</span> <span class="n">input_vec</span><span class="p">)</span>
      <span class="n">sysout</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;My Response --&gt; </span><span class="si">{</span><span class="n">vectostr</span><span class="p">(</span><span class="n">output_vec</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="n">output_vec</span> <span class="o">=</span> <span class="p">(</span><span class="n">SECRET_KEY</span> <span class="o">@</span> <span class="n">input_vec</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">1</span>
      <span class="n">sysout</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;My Response --&gt; </span><span class="si">{</span><span class="n">vectostr</span><span class="p">(</span><span class="n">output_vec</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p><img alt="Pasted image 20220829163804.png" src="../Media/Pasted%20image%2020220829163804.png" /></p>
<h4 id="sending-payload-challenges">Sending Payload Challenges<a class="headerlink" href="#sending-payload-challenges" title="Permanent link">&para;</a></h4>
<p><img alt="Pasted image 20220829181142.png" src="../Media/Pasted%20image%2020220829181142.png" /></p>
<div class="highlight"><pre><span></span><code>1 0 1 0 1 0 0 1
1 0 1 0 0 1 1 0
1 1 1 1 0 0 1 1
0 0 1 0 1 0 0 0
0 0 1 0 0 1 1 1
1 0 1 0 0 1 1 0
1 1 1 0 1 1 1 1
0 0 0 0 0 1 1 1
</code></pre></div>
<p><img alt="Pasted image 20220829181215.png" src="../Media/Pasted%20image%2020220829181215.png" /></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">sysout</span><span class="p">(</span><span class="n">fstr</span><span class="p">):</span>
   <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fstr</span><span class="p">)</span>
   <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">vectostr</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
   <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">strtovec</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">)</span>

<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="s1">&#39;1 0 1 0 1 0 0 1;1 0 1 0 0 1 1 0;1 1 1 1 0 0 1 1;0 0 1 0 1 0 0 0;0 0 1 0 0 1 1 1;1 0 1 0 0 1 1 0;1 1 1 0 1 1 1 1;0 0 0 0 0 1 1 1&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
   <span class="nb">print</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">)</span>
   <span class="n">input2</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Challenge &lt;-- &quot;</span><span class="p">)</span>
   <span class="n">input2</span> <span class="o">=</span> <span class="n">strtovec</span><span class="p">(</span><span class="n">input2</span><span class="p">)</span>
<span class="c1">#   output = (SECRET_KEY@input2)</span>
<span class="c1">#   sysout(f&quot;Answer --&gt; {vectostr(output)}\n&quot;)</span>
   <span class="n">output</span> <span class="o">=</span> <span class="p">(</span><span class="n">SECRET_KEY</span><span class="nd">@input2</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">1</span>
   <span class="n">sysout</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Answer --&gt; </span><span class="si">{</span><span class="n">vectostr</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p><img alt="Pasted image 20220829181155.png" src="../Media/Pasted%20image%2020220829181155.png" /></p>
<h2 id="level-3-patient0-part-1">Level 3 : Patient0 - Part 1<a class="headerlink" href="#level-3-patient0-part-1" title="Permanent link">&para;</a></h2>
<p>Palindrome has spread some virus to corrupt machines causing incorrect readings in patients' health measurements and rending them unusable. Inspect the file and see if you can uncover the 8 corrupted bytes that renders the file system unusable? </p>
<h4 id="recon_1">Recon<a class="headerlink" href="#recon_1" title="Permanent link">&para;</a></h4>
<ul>
<li>Using File we realise that this file is a NTFS drive.</li>
</ul>
<p><img alt="Pasted image 20220829193859.png" src="../Media/Pasted%20image%2020220829193859.png" /></p>
<ul>
<li>We first repair drive with test disk.</li>
</ul>
<div class="highlight"><pre><span></span><code>testdisk PATIENT0
</code></pre></div>
<ul>
<li>Then we compare the unrepaired file with the repaired file.</li>
</ul>
<div class="highlight"><pre><span></span><code>xxd PATIENT0 &gt; PATIENT0.hex
xxd PATIENT0_repaired &gt; PATIENT0_repaired.hex
diff PATIENT0.hex PATIENT0_repaired.hex
</code></pre></div>
<p><img alt="Pasted image 20220830003212.png" src="../Media/Pasted%20image%2020220830003212.png" /></p>
<ul>
<li>We can tell that the 8 continuous bytes that was changed was <code>f766 35ab</code> therefore the flag for this challenge is <code>TISC{f76635ab}</code>.</li>
</ul>
<h2 id="level-3-patient-0-part-2">Level 3 : PATIENT 0 - Part 2<a class="headerlink" href="#level-3-patient-0-part-2" title="Permanent link">&para;</a></h2>
<p>Palindrome must have leaked one of their passwords as the 4 corrupted bytes (Part 1 flag)! Dig deeper to find what was hidden! </p>
<h3 id="hints">Hints<a class="headerlink" href="#hints" title="Permanent link">&para;</a></h3>
<p><img alt="Pasted image 20220830005958.png" src="../Media/Pasted%20image%2020220830005958.png" />
<img alt="Pasted image 20220830010014.png" src="../Media/Pasted%20image%2020220830010014.png" />
<img alt="Pasted image 20220830010030.png" src="../Media/Pasted%20image%2020220830010030.png" />
<img alt="Pasted image 20220830201738.png" src="../Media/Pasted%20image%2020220830201738.png" /></p>
<h3 id="recon_2">Recon<a class="headerlink" href="#recon_2" title="Permanent link">&para;</a></h3>
<ul>
<li>In the Recon stage, we look around the repaired file systems for clues as stated in the hints and the following clues were found : <a href="#message-png">#message png</a>, <a href="#message-png-ads">#message png ADS</a>, <a href="#broken-pdf">#broken pdf</a>.</li>
</ul>
<h4 id="messagepng">message.png<a class="headerlink" href="#messagepng" title="Permanent link">&para;</a></h4>
<p><img alt="Pasted image 20220830010622.png" src="../Media/Pasted%20image%2020220830010622.png" />
<img alt="Pasted image 20220830010558.png" src="../Media/Pasted%20image%2020220830010558.png" /></p>
<h4 id="messagepng-ads">message.png ADS<a class="headerlink" href="#messagepng-ads" title="Permanent link">&para;</a></h4>
<p><img alt="Pasted image 20220830013120.png" src="../Media/Pasted%20image%2020220830013120.png" />
<img alt="Pasted image 20220830013140.png" src="../Media/Pasted%20image%2020220830013140.png" />
<img alt="Pasted image 20220830015328.png" src="../Media/Pasted%20image%2020220830015328.png" /></p>
<h4 id="brokenpdf">broken.pdf<a class="headerlink" href="#brokenpdf" title="Permanent link">&para;</a></h4>
<p><img alt="Pasted image 20220830011441.png" src="../Media/Pasted%20image%2020220830011441.png" /></p>
<h3 id="unlocking-outer">Unlocking Outer<a class="headerlink" href="#unlocking-outer" title="Permanent link">&para;</a></h3>
<ul>
<li>Taking the ADS <code>$RAND</code> we removed the clue strings with hex editors and proceeded to mount the file with TrueCrypt (derived from the clue and hints) and used the flag for <a href="#level-3-patient0---part-1">#Level 3 Patient0 - Part 1</a> as password.</li>
</ul>
<p><img alt="Pasted image 20220830021155.png" src="../Media/Pasted%20image%2020220830021155.png" /></p>
<ul>
<li>The mounting was successful as can be seen above and we see an image file below.</li>
</ul>
<p><img alt="Pasted image 20220830021044.png" src="../Media/Pasted%20image%2020220830021044.png" /></p>
<ul>
<li>Following this <a href="https://hashcat.net/forum/thread-5861.html">link</a> and the below comment : </li>
</ul>
<p><img alt="Pasted image 20220830203643.png" src="../Media/Pasted%20image%2020220830203643.png" /></p>
<ul>
<li>Following the instructions above we get the following : </li>
</ul>
<p><img alt="Pasted image 20220830204744.png" src="../Media/Pasted%20image%2020220830204744.png" />
<img alt="Pasted image 20220830203020.png" src="../Media/Pasted%20image%2020220830203020.png" /></p>
<ul>
<li>As can be seen, there is a hash collision that resembles what clue 4 has given : <code>c01lis1on</code>. With this as password, we managed to unlock the hidden compartment of the encrypted volume,</li>
</ul>
<p><img alt="Pasted image 20220830203210.png" src="../Media/Pasted%20image%2020220830203210.png" /></p>
<ul>
<li>There is a <code>flag.ppsm</code> file (macro-enabled powerpoint) and it corresponds with the <code>PK</code> header which stands for ZIP or compressed format - Powerpoint files are a kind of zipped files.</li>
</ul>
<p><img alt="Pasted image 20220830203231.png" src="../Media/Pasted%20image%2020220830203231.png" /></p>
<ul>
<li>Using 7zip, we unzipped the ppsm file and we checked Media to see if there is any media within the powerpoint.</li>
</ul>
<p><img alt="Pasted image 20220830203411.png" src="../Media/Pasted%20image%2020220830203411.png" />
<img alt="Pasted image 20220830203509.png" src="../Media/Pasted%20image%2020220830203509.png" />
<img alt="Pasted image 20220830203454.png" src="../Media/Pasted%20image%2020220830203454.png" /></p>
<ul>
<li>We opened one of the images and it says to get a <code>MD5</code> hash of the sound clip to get the flag. </li>
</ul>
<p><img alt="Pasted image 20220830203434.png" src="../Media/Pasted%20image%2020220830203434.png" /></p>
<ul>
<li>We get the hash of the sound clip with certutil and the result is below : </li>
</ul>
<p><img alt="Pasted image 20220830204043.png" src="../Media/Pasted%20image%2020220830204043.png" /></p>
<div class="highlight"><pre><span></span><code>Flag : TISC{f9fc54d767edc937fc24f7827bf91cfe}
</code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.81fa17fe.min.js"></script>
      
    
  </body>
</html>